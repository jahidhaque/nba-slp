"use strict";!function(){angular.module("nbaslp",["ngResource","ngRoute"]).config(["$routeProvider","$locationProvider",function(l,e){l.when("/",{templateUrl:"home/welcome/welcome.view.html",controller:"welcomeCtrl",controllerAs:"wvm"}).when("/signup",{templateUrl:"signup/signup.view.html",controller:"signupCtrl",controllerAs:"regvm"}).when("/signin",{templateUrl:"signin/signin.view.html",controller:"signinCtrl",controllerAs:"lvm"}).when("/profile",{templateUrl:"profile/profile.view.html",controller:"profileCtrl",controllerAs:"provm"}).when("/help",{templateUrl:"help/help.view.html",controller:"helpCtrl",controllerAs:"hvm"}).when("/sitecontroll",{templateUrl:"admin/sitecontroll/sitecontroll.view.html",controller:"sitecontrollCtrl",controllerAs:"adSite"}).when("/welcome",{templateUrl:"welcome/welcome.view.html",controller:"welcomeCtrl",controllerAs:"wvm"}),e.html5Mode({enabled:!0})}])}();
"use strict";function authentication(n,t){var e=function(t){n.localStorage.nbaslp=t},a=function(){return n.localStorage.nbaslp},o=function(){var t=a(),e=void 0;return!!t&&(e=t.split(".")[1],e=n.atob(e),e=JSON.parse(e))};return{currentUser:function(){if(o){var t=a().split(".")[1];return t=n.atob(t),t=JSON.parse(t),{userId:t._id,email:t.email,accountStatus:t.accountStatus,accountType:t.accountType,accountId:t.userId,name:t.name}}return!1},saveToken:e,getToken:a,isLoggedIn:o,signUp:function(n){return t.post("/api/signup",n).success(function(n){e(n.token)})},signIn:function(n){return t.post("/api/signin",n).success(function(n){e(n.token)})},Logout:function(){n.localStorage.removeItem("nbaslp")}}}angular.module("nbaslp").service("authentication",authentication),authentication.$inject=["$window","$http"];
"use strict";!function(){function t(t,n){var e=function(t){return t},c=function(t){return t};return{getAccountStatuses:function(t){return n.get("/api/"+t+"/statuses").then(e).catch(c)},updateUserStatus:function(t){return n.post("/api/userstatus",t).then(e).catch(c)},saveBasicInfo:function(t){return n.post("/api/createbasicprofile",t).then(e).catch(c)},saveBranchInfo:function(t,a){return n.post("/api/"+t+"/savebranchinfo",a).then(e).catch(c)},loadUserInfo:function(t,a){return n.get("/api/"+a+"/"+t+"/userinfo").then(e).catch(c)}}}angular.module("nbaslp").service("account",t),t.$inject=["$window","$http"]}();
"use strict";!function(){function t(t){var e=function(t){return t},n=function(t){return t};return{addPreferredCommittee:function(r){return t.post("/api/createcommittee",r).then(e).catch(n)},showAllCommittee:function(){return t.get("/api/showcommittee").then(e).catch(n)},removeCommittee:function(r){return t.delete("/api/"+r+"/removecommittee").then(e).catch(n)}}}angular.module("nbaslp").service("sitecontroller",t),t.$inject=["$http"]}();
"use strict";!function(){angular.module("nbaslp").directive("siteNav",function(){return{restrict:"EA",templateUrl:"common/directives/nav/site-nav.template.html",controller:"navCtrl as nvm"}})}();
"use strict";!function(){function n(n,t){n.isLoggedIn()?(this.loggedInUri=!0,this.loggedInName=n.currentUser().name,this.currentAccountType=n.currentUser().accountType,console.log(this.currentAccountType)):this.loggedInUri=!1,this.logout=function(){n.Logout(),t.path("/signin")}}angular.module("nbaslp").controller("navCtrl",n),n.$inject=["authentication","$location"]}();
"use strict";!function(){angular.module("nbaslp").directive("siteFooter",function(){return{restrict:"EA",templateUrl:"common/directives/footer/footer.template.html"}})}();
"use strict";!function(){angular.module("nbaslp").controller("welcomeCtrl",function(){})}();
"use strict";!function(){function r(r,t){var o=this;o.user={firstName:"",lastName:"",displayName:"",email:"",password:"",confirmPassword:""},o.register=function(){r.signUp(o.user).then(function(r){r.data.error?(o.RegistrationError=!0,o.RegistrationErrorMsg=r.data.error):(o.RegistrationError=!1,t.path("/welcome"))}).catch(function(r){r&&(o.RegistrationError=!0,o.RegistrationErrorMsg=r.data.error)})},r.isLoggedIn()&&t.path("/welcome")}angular.module("nbaslp").controller("signupCtrl",r),r.$inject=["authentication","$location"]}();
"use strict";!function(){function r(r,o){var n=this;n.user={email:"",password:""},r.isLoggedIn()?o.path("/welcome"):(n.login=function(){n.user.email&&n.user.password?(n.loginError=!1,n.doLogin()):(n.loginError=!0,n.loginErrorMsg="Error! all * fields are required")},n.doLogin=function(){r.signIn(n.user).error(function(r){n.loginError=!0,n.loginErrorMsg=r.error}).then(function(){o.path("/welcome")})})}angular.module("nbaslp").controller("signinCtrl",r),r.$inject=["authentication","$location"]}();
"use strict";!function(){function r(r,a,o,n){var t=this;r.isLoggedIn()?(t.profileStatus=r.currentUser().accountStatus,t.currentAccountType=r.currentUser().accountType,"customer"===r.currentUser().accountType?(t.getProfileStatuses=function(){o.getAccountStatuses(r.currentUser().email).then(function(r){r.data.error?(t.statusLoadError=!0,t.statusLoadErrorMsg=r.data.error):(t.statusLoadError=!1,t.userStatuses=r.data.statuses)}).catch(function(r){t.statusLoadError=!0,t.statusLoadErrorMsg=r})},t.basicProfile={whos:r.currentUser().email,userId:r.currentUser().userId,formerName:"",sex:"",tele:"",address:""},t.saveBasicInfo=function(){o.saveBasicInfo(t.basicProfile).then(function(a){if(a.data.error)t.basicAccountInfoError=!0,t.basicAccountInfoErrorMsg=a.data.error;else{var e={update_at:"basic_info",email:r.currentUser().email,status:!0};o.updateUserStatus(e).then(function(r){!0===r.data.updated?(t.statusUpdateError=!1,n.reload()):(t.basicAccountInfoError=!0,t.basicAccountInfoErrorMsg=r.data.error)}).catch(function(r){t.statusUpdateError=!0,t.basicAccountInfoErrorMsg=r})}}).catch(function(r){})},t.branch={year:"",branch:""},t.saveBatchInfo=function(){o.saveBranchInfo(r.currentUser().email,t.branch).then(function(a){if(a.data.error)t.branchInfoError=!0,t.branchInfoErrorMsg=a.data.error;else if(a.data.success){t.branchInfoError=!1;var e={update_at:"branch",email:r.currentUser().email,status:!0};o.updateUserStatus(e).then(function(r){!0===r.data.updated?(t.branchInfoError=!1,n.reload()):(t.branchInfoError=!0,t.branchInfoErrorMsg=r.data.error)}).catch(function(r){t.branchInfoError=!0,t.branchInfoErrorMsg=r})}}).catch(function(r){t.branchInfoError=!0,t.branchInfoErrorMsg=r})},t.loadBasicInfo=function(a){o.loadUserInfo(a,r.currentUser().email).then(function(r){r.data.error?(t.userBasicInfoLoadingError=!0,t.userBasicInfoLoadingErrorMsg=r.data.error):(t.userBasicInfoLoadingError=!1,t.basicInfo=r.data.userInfo)}).catch(function(r){t.userBasicInfoLoadingError=!0,t.userBasicInfoLoadingErrorMsg=r})},t.loadUserBranch=function(a){o.loadUserInfo(a,r.currentUser().email).then(function(r){r.data.error?(t.userInfoLoadingError=!0,t.userInfoLoadingErrorMsg=r.data.error):(t.userInfoLoadingError=!1,t.branchInfo=r.data.userInfo)}).catch(function(r){t.userInfoLoadingError=!0,t.userInfoLoadingErrorMsg=r})}):r.currentUser().accountType):a.path("/signin")}angular.module("nbaslp").controller("profileCtrl",r),r.$inject=["authentication","$location","account","$route"]}();
"use strict";!function(){function n(n,t){}angular.module("nbaslp").controller("welcomeCtrl",n),n.$inject=["authentication","$location"]}();
"use strict";!function(){function t(t,e,o){var r=this;t.isLoggedIn()?"admin"===t.currentUser().accountType?(r.committee={name:""},r.addPreferredCommittee=function(){o.addPreferredCommittee(r.committee).then(function(t){t.data.error?(r.addCommitteeError=!0,r.addCommitteeErrorMsg=t.data.error):(r.addCommitteeError=!1,r.addCommitteeSuccessMsg="Committee successfully added",setTimeout(function(){r.showCommittee()},200))}).catch(function(t){r.addCommitteeError=!0,r.addCommitteeErrorMsg=t})},r.showCommittee=function(){o.showAllCommittee().then(function(t){t.data.error?(r.committeeError=!0,r.committeeErrorMsg=t.data.error):(r.committeeError=!1,r.committeeList=t.data.committee)}).catch(function(t){r.committeeError=!0,r.committeeErrorMsg=t})},r.removeList=function(t){o.removeCommittee(t).then(function(t){t.data.error?alert(t.data.error):setTimeout(function(){r.showCommittee()},100)}).catch(function(t){alert(t)})}):e.path("/welcome"):e.path("/signin")}angular.module("nbaslp").controller("sitecontrollCtrl",t),t.$inject=["authentication","$location","sitecontroller"]}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsImF1dGhlbnRpY2F0aW9uLnNlcnZpY2UuanMiLCJhY2NvdW50LnNlcnZpY2UuanMiLCJzaXRlLWNvbnRyb2xsZXIuc2VydmljZS5qcyIsIm5hdi5kaXJlY3RpdmUuanMiLCJuYXYuY29udHJvbGxlci5qcyIsImZvb3Rlci5kaXJlY3RpdmUuanMiLCJ3ZWxjb21lLmNvbnRyb2xsZXIuanMiLCJzaWdudXAuY29udHJvbGxlci5qcyIsInNpZ25pbi5jb250cm9sbGVyLmpzIiwicHJvZmlsZS5jb250cm9sbGVyLmpzIiwic2l0ZWNvbnRyb2xsLmNvbnRyb2xsZXIuanMiXSwibmFtZXMiOlsiYW5ndWxhciIsIm1vZHVsZSIsImNvbmZpZyIsInRlbXBsYXRlVXJsIiwiJGxvY2F0aW9uUHJvdmlkZXIiLCJjb250cm9sbGVyIiwiY29udHJvbGxlckFzIiwid2hlbiIsImh0bWw1TW9kZSIsImVuYWJsZWQiLCJzYXZlVG9rZW4iLCIkd2luZG93IiwidG9rZW4iLCJsb2NhbFN0b3JhZ2UiLCJnZXRUb2tlbiIsImlzTG9nZ2VkSW4iLCJwYXlsb2FkIiwiSlNPTiIsInBhcnNlIiwiYXRvYiIsImN1cnJlbnRVc2VyIiwic3BsaXQiLCJhY2NvdW50U3RhdHVzIiwidXNlcklkIiwiX2lkIiwiYWNjb3VudFR5cGUiLCJhY2NvdW50SWQiLCJuYW1lIiwiTG9nb3V0Iiwic2lnblVwIiwidXNlciIsIiRodHRwIiwicG9zdCIsInN1Y2Nlc3MiLCJkYXRhIiwic2lnbkluIiwiaGFuZGxlU3VjY2VzcyIsInJlbW92ZUl0ZW0iLCJhdXRoZW50aWNhdGlvbiIsImdldEFjY291bnRTdGF0dXNlcyIsInJlc3BvbnNlIiwiaGFuZGxlRXJyb3IiLCJ1cGRhdGVVc2VyU3RhdHVzIiwidGhlbiIsImNhdGNoIiwic2F2ZUJyYW5jaEluZm8iLCJzYXZlQmFzaWNJbmZvIiwibG9hZFVzZXJJbmZvIiwiY29sbGVjdGlvbk5hbWUiLCJhY2NvdW50IiwiJGluamVjdCIsImFkZFByZWZlcnJlZENvbW1pdHRlZSIsInJlbW92ZUNvbW1pdHRlZSIsInNob3dBbGxDb21taXR0ZWUiLCJnZXQiLCJjb21taXR0ZWVJZCIsImRlbGV0ZSIsInNpdGVjb250cm9sbGVyIiwiZGlyZWN0aXZlIiwic2l0ZU5hdiIsInJlc3RyaWN0IiwibmF2Q3RybCIsIiRsb2NhdGlvbiIsIm52bSIsImxvZ2dlZEluTmFtZSIsImxvZ2dlZEluVXJpIiwiY3VycmVudEFjY291bnRUeXBlIiwibG9nb3V0IiwicGF0aCIsInNpdGVGb290ZXIiLCJzaWdudXBDdHJsIiwicmVndm0iLCJ0aGlzIiwibGFzdE5hbWUiLCJkaXNwbGF5TmFtZSIsImVtYWlsIiwicGFzc3dvcmQiLCJjb25maXJtUGFzc3dvcmQiLCJyZWdpc3RlciIsIlJlZ2lzdHJhdGlvbkVycm9yTXNnIiwiUmVnaXN0cmF0aW9uRXJyb3IiLCJlcnJvciIsImVyciIsInNpZ25pbkN0cmwiLCJsdm0iLCJsb2dpbkVycm9yTXNnIiwibG9naW5FcnJvciIsImRvTG9naW4iLCJwcm92bSIsIiRyb3V0ZSIsImdldFByb2ZpbGVTdGF0dXNlcyIsInN0YXR1c0xvYWRFcnJvck1zZyIsInN0YXR1c0xvYWRFcnJvciIsInVzZXJTdGF0dXNlcyIsInN0YXR1c2VzIiwiYmFzaWNQcm9maWxlIiwiYWRkcmVzcyIsIndob3MiLCJ0ZWxlIiwidXBkYXRlX2F0Iiwic3RhdHVzIiwiYmFzaWNBY2NvdW50SW5mb0Vycm9yIiwiYmFzaWNBY2NvdW50SW5mb0Vycm9yTXNnIiwicmVsb2FkIiwidXBkYXRlZCIsInN0YXR1c1VwZGF0ZUVycm9yIiwiYnJhbmNoIiwic2F2ZUJhdGNoSW5mbyIsImJyYW5jaEluZm9FcnJvciIsImJyYW5jaEluZm9FcnJvck1zZyIsInVwZGF0ZWRTdGF0dXMiLCJ1c2VyQmFzaWNJbmZvTG9hZGluZ0Vycm9yIiwidXNlckJhc2ljSW5mb0xvYWRpbmdFcnJvck1zZyIsInVzZXJJbmZvTG9hZGluZ0Vycm9yIiwibG9hZEJhc2ljSW5mbyIsInVzZXJJbmZvTG9hZGluZ0Vycm9yTXNnIiwiYmFzaWNJbmZvIiwidXNlckluZm8iLCJsb2FkVXNlckJyYW5jaCIsImJyYW5jaEluZm8iLCJwcm9maWxlQ3RybCIsIndlbGNvbWVDdHJsIiwic2l0ZWNvbnRyb2xsQ3RybCIsImFkU2l0ZSIsImNvbW1pdHRlZSIsImFkZENvbW1pdHRlZUVycm9yTXNnIiwiYWRkQ29tbWl0dGVlRXJyb3IiLCJhZGRDb21taXR0ZWVTdWNjZXNzTXNnIiwic2hvd0NvbW1pdHRlZSIsImNvbW1pdHRlZUVycm9yIiwiY29tbWl0dGVlRXJyb3JNc2ciLCJyZW1vdmVMaXN0IiwiY29tbWl0dGVlTGlzdCIsImFsZXJ0Iiwic2V0VGltZW91dCJdLCJtYXBwaW5ncyI6IkFBUUEsY0FFQSxXQUNJQSxRQUNLQyxPQUFPLFVBQVcsYUFBYyxZQUdyQ0MsUUFBU0EsaUJBQVQsb0JBR1lDLFNBQUFBLEVBQWFDLEdBQ2JDLEVBQ0FDLEtBQUFBLEtBRUVILFlBQVcsaUNBQ2JBLFdBQWEsY0FDYkUsYUFBWSxRQUdmRSxLQUFLLFdBQ0ZKLFlBQWEsMEJBQ2JFLFdBQVksYUFDWkMsYUFBYyxVQUdkSCxLQUFBQSxXQUNBRSxZQUFZLDBCQUNaQyxXQUFjLGFBRVpBLGFBQVMsUUFFWEQsS0FBQUEsWUFDQUMsWUFBYyw0QkFFWkQsV0FBQSxjQUNGRixhQUFhLFVBRWJHLEtBQUFBLFNBRUVILFlBQVksc0JBQ2RBLFdBQWEsV0FDYkUsYUFBWSxRQWpDcEJFLEtBQUEsaUJBMkJRSixZQUFhLDRDQVVyQkMsV0FBa0JJLG1CQUNkQyxhQUFTLFdBRWhCRixLQUFBLFlBOUNMSixZQUFBLDRCQXVDZ0JFLFdBQVksY0FDWkMsYUFBYyxRQUd0QkYsRUFBa0JJLFdBQ2RDLFNBQVMsT0E1Q3JCO0FDRkEsYUFVSSxTQUFNQyxlQUFZQyxFQUFaRCxHQUVMLElBRkRBLEVBQUEsU0FBQUUsR0FDSUQsRUFBUUUsYUFBUixPQUFpQ0QsR0FHckNFLEVBQUEsV0FDSSxPQUFPSCxFQUFRRSxhQUFSLFFBS1BFLEVBQUlDLFdBREosSUFBTUosRUFBUUUsSUFHVkYsT0FBQUEsRUFFQUksUUFBQUEsSUFDQUEsRUFBVUMsRUFBS0MsTUFBTUYsS0FBQUEsR0FDckJBLEVBQU9BLEVBQVBHLEtBQUFILEdBSkpBLEVBTUtDLEtBQUFDLE1BQUFGLEtBOENULE9BQ0lJLFlBdkNRSixXQUNKQSxHQUFBQSxFQUFVTCxDQUNWSyxJQUZJQSxFQUVNQyxJQUZVSSxNQUFNLEtBQUssR0FPM0JDLE9BSEpOLEVBQU9MLEVBQUFRLEtBQUFILEdBQ0hPLEVBQUFBLEtBQVFQLE1BQVFRLElBR2hCQyxPQUFBQSxFQUFhVCxJQUNiVSxNQUFBQSxFQUFXVixNQUNYVyxjQUFjQSxFQUFBQSxjQU5sQkYsWUFBQVQsRUFBQVMsWUFTQ0MsVUFBQVYsRUFBQU8sT0FDREksS0FBT1gsRUFBUFcsTUFJRkMsT0FBUyxHQXNCWGxCLFVBQVdBLEVBQ1hJLFNBQVVBLEVBQ1ZDLFdBQVlBLEVBQ1pjLE9BckJKLFNBQUFDLEdBQ0ksT0FBT0MsRUFBTUMsS0FBSyxjQUFlRixHQUFNRyxRQUFRLFNBQVVDLEdBS3ZEQyxFQUFTRCxFQUFUQyxVQWdCRkEsT0FoQkosU0FBQUwsR0FDSSxPQUFPQyxFQUFNQyxLQUFLLGNBQWVGLEdBQU1HLFFBQVEsU0FBVUMsR0FLdkRFLEVBQUFBLEVBQWdCeEIsVUFXbEJnQixPQXZCVyxXQUNYakIsRUFBT29CLGFBQVdNLFdBQVgsWUF6RGZyQyxRQUNLQyxPQUFPLFVBR1pxQyxRQUFBQSxpQkFBMEJBLGdCQUUxQkEsZUFBU0EsU0FBZTNCLFVBQVNvQjtBQ1JqQyxjQUVBLFdBU1EsU0FBTVEsRUFBQUEsRUFBQUEsR0FLTCxJQW9DS0gsRUFBZ0IsU0FBQ0ksR0FBRCxPQUFjQSxHQUU5QkMsRUFBYyxTQUFDRCxHQUFELE9BQWNBLEdBRWxDLE9BQ0lELG1CQTlDSixTQUFBaEIsR0FDSSxPQUFPUSxFQU1MVyxJQUFBQSxRQUFtQm5CLEVBQW5CbUIsYUFDRkMsS0FBT1osR0FEWGEsTUFBQUgsSUF3Q0lDLGlCQS9CVSxTQUFBUixHQUZkLE9BQUFILEVBTFNDLEtBQUssa0JBQW1CRSxHQVkzQlcsS0FBQUEsR0FDRkQsTUFBT2IsSUEwQlBlLGNBcEJKLFNBQUFaLEdBYkksT0FBT0gsRUFDRkMsS0FBSywwQkFBMkJFLEdBQ2hDUyxLQUFLUCxHQUNMUSxNQUFNSCxJQStCWEksZUFiUyxTQUFBdEIsRUFBVUEsR0FGdkIsT0FBQVEsRUFYU0MsS0FBSyxRQUFVVCxFQUFTLGtCQUFtQlcsR0FrQjlDRSxLQUFBQSxHQUFnQlEsTUFBY0osSUFTaENPLGFBSEFMLFNBQWtCQSxFQUZmbkIsR0FHSHVCLE9BQUFBLEVBQ0FELElBQUFBLFFBQWdCQSxFQUFBQSxJQUpiRyxFQUFBLGFBS0hELEtBQUFBLEdBTEpILE1BQUFILEtBckRKekMsUUFDS0MsT0FBTyxVQUdaZ0QsUUFBUUMsVUFBV0QsR0FFbkJBLEVBQUFDLFNBQWlCdkMsVUFBU29CLFNBUDlCO0FDRkEsY0FFQSxXQVVRLFNBQU1vQixFQUFBQSxHQUtMLElBdUJHQyxFQUFpQkEsU0FBQUEsR0FBQUEsT0FBQUEsR0FHeEJYLEVBQUEsU0FBQUQsR0FBQSxPQUFBQSxHQU5HLE9BQ0lXLHNCQTFCSixTQUFBakIsR0FDSSxPQUFPSCxFQU1Mc0IsS0FBQUEsdUJBQUFBLEdBQ0ZWLEtBQU9aLEdBRFhhLE1BQUFILElBb0JJWSxpQkFYWSxXQUZoQixPQUFBdEIsRUFMU3VCLElBQUksc0JBWVBsQixLQUFBQSxHQUFnQlEsTUFBY0osSUFPaENZLGdCQUxnQixTQUFBRyxHQUFBLE9BQWNmLEVBQWxDZ0IsT0FBQSxRQUFBRCxFQUFBLG9CQU5TWixLQUFLUCxHQVFQUSxNQUFBSCxLQWpDWHpDLFFBQ0tDLE9BQU8sVUFHWndELFFBQUFBLGlCQUEwQkEsR0FFMUJBLEVBQVNBLFNBQWUxQixTQVI1QjtBQ0ZBLGNBRUEsV0FDSS9CLFFBQ0tDLE9BQU8sVUFHWnlELFVBQVNDLFVBRURDLFdBQ0F6RCxPQUNBRSxTQUFBQSxLQUhKRixZQUFBLCtDQUtIRSxXQUFBLG9CQVhMO0FDRkEsY0FFQSxXQU9JLFNBQVN3RCxFQUFRdkIsRUFBZ0J3QixHQUt6QkMsRUFBSUMsY0FGSjFCLEtBQ0kyQixhQUFjLEVBRGxCM0IsS0FJSTRCLGFBQUFBLEVBQXFCNUIsY0FBZWxCLEtBSnhDa0IsS0FPQzRCLG1CQUFBNUIsRUFBQWxCLGNBQUFLLFlBQ0RzQyxRQUFJRSxJQVJKM0IsS0FRQTRCLHFCQVJBNUIsS0FXQTZCLGFBQVMsRUFYVDdCLEtBV0o2QixPQUFBLFdBSUg3QixFQUFBVixTQXpCTGtDLEVBQUFNLEtBQUEsWUFDSXBFLFFBQ0tDLE9BQU8sVUFHWjRELFdBQUEsVUFBbUJBLEdBRW5CQSxFQUFBWCxTQUFpQlosaUJBQWdCd0IsYUFQckM7QUNGQSxjQUVBLFdBQ0k5RCxRQUdBQyxPQUFTb0UsVUFDTFgsVUFBTyxhQUNIRSxXQUNBekQsT0FGSnlELFNBQUEsS0FJSHpELFlBQUEsbURBVEw7QUNIQSxjQUNBLFdBQUNILFFBQ0FBLE9BQ0VDLFVBQ0FJLFdBQVcsY0FHWixjQU5GO0FDQUEsY0FFQSxXQU9JLFNBQVNpRSxFQUFXaEMsRUFBZ0J3QixHQUdoQyxJQUFBUyxFQUFBQyxLQUdJQyxFQUFBQSxNQUNBQyxVQUFBQSxHQUNBQyxTQUpTLEdBS1RDLFlBTFMsR0FNVEMsTUFBQUEsR0FOSkQsU0FBQSxHQU1JQyxnQkFBaUIsSUFPVE4sRUFBQU8sU0FBSXRDLFdBQ0ErQixFQUNBQSxPQUFBQSxFQUFNUSxNQUZWcEMsS0FBQSxTQUlLSCxHQUNEK0IsRUFBTVMsS0FBQUEsT0FDTmxCLEVBQVVNLG1CQUFWLEVBQ0hHLEVBQUFRLHFCQUFBdkMsRUFBQU4sS0FBQStDLFFBSUdWLEVBQU1TLG1CQUFOLEVBQ0FULEVBQU1RLEtBQUFBLGVBaEJ0Qm5DLE1BQUEsU0FBQXNDLEdBY2dCQSxJQU9aNUMsRUFBZXZCLG1CQUFjLEVBQ25CcUQsRUFBS1cscUJBQWZHLEVBQUFoRCxLQUFBK0MsVUFEQTNDLEVBQWV2QixjQUNmK0MsRUFBVU0sS0FBSyxZQXpDdkJwRSxRQUNLQyxPQUFPLFVBR1pxRSxXQUFXcEIsYUFBV29CLEdBRXRCQSxFQUFTQSxTQUFXaEMsaUJBQWdCd0IsYUFQeEM7QUNGQSxjQUVBLFdBT0ksU0FBU3FCLEVBQVc3QyxFQUFnQndCLEdBR2hDc0IsSUFBSXRELEVBQU8wQyxLQUVQSSxFQUFBQSxNQUZKRCxNQUFBLEdBRUlDLFNBQVUsSUFHZHRDLEVBR0t2QixhQUNEcUUsRUFBQWhCLEtBQVksYUFHSmdCLEVBQUFBLE1BQUlDLFdBRlJELEVBSUt0RCxLQUFBNkMsT0FBQVMsRUFBQXRELEtBQUE4QyxVQUNEUSxFQUFJRSxZQUFhLEVBS3JCQyxFQUFKQSxZQUxRSCxFQUFJRSxZQUFhLEVBQ2pCRixFQUFJRyxjQUFKSCxxQ0FVQ0EsRUFBQUcsUUFDSyxXQUNGekIsRUFQUjNCLE9BQUFpRCxFQUFBdEQsTUFESm1ELE1BQUEsU0FBQUMsR0FXSEUsRUFBQUUsWUFBQSxFQUNKRixFQUFBQyxjQUFBSCxFQUFBRCxRQUxnQnRDLEtBQUssV0FDRm1CLEVBQVVNLEtBQUssZ0JBckNuQ3BFLFFBQ0tDLE9BQU8sVUFHWmtGLFdBQVdqQyxhQUFXaUMsR0FFdEJBLEVBQVNBLFNBQVc3QyxpQkFBZ0J3QixhQVB4QztBQ0ZBLGNBRUEsV0FVUSxTQUFNMEIsRUFBTmxELEVBQUF3QixFQUFBYixFQUFBd0MsR0FFQSxJQUFJbkQsRUFBQUEsS0FBQUEsRUFBZXZCLGNBR2Z5RSxFQUFNdEIsY0FBQUEsRUFBcUI1QixjQUFlbEIsY0FFMUNvRSxFQUFBdEIsbUJBQUE1QixFQUFBbEIsY0FBQUssWUFHSSxhQUFBYSxFQUFBbEIsY0FBQUssYUFLWStELEVBQUFFLG1CQUFrQlQsV0FDZE8sRUFDQUEsbUJBQU1HLEVBQXFCbkQsY0FBY3lDLE9BRjdDdEMsS0FBQSxTQUFBSCxHQUtJZ0QsRUFBTUksS0FBQUEsT0FDTkosRUFBTUssaUJBQWVyRCxFQUN4QmdELEVBQUFHLG1CQUFBbkQsRUFBQU4sS0FBQStDLFFBSUtVLEVBQUFBLGlCQUFOLEVBZFJILEVBQUFLLGFBQUFyRCxFQUFBTixLQUFBNEQsWUFrQkpsRCxNQUFBLFNBQUFzQyxHQUNNYSxFQUFOSCxpQkFBcUIsRUFDWHRELEVBQUFBLG1CQUE2QnFDLEtBS25DcUIsRUFBQUEsY0FOSkMsS0FBQTNELEVBQUFsQixjQUFBdUQsTUFFSXBELE9BQVFlLEVBQWVsQixjQUFjRyxPQU96Q2lFLFdBQU0xQyxHQUNGRyxJQUFBQSxHQUdRaUQsS0FBQSxHQUNJVixRQUFBQSxJQUxoQkEsRUFBTTFDLGNBQWdCLFdBVU5HLEVBQ0lrRCxjQUFBQSxFQUFXSixjQUNYcEIsS0FBQUEsU0FBQUEsR0FDQXlCLEdBQUFBLEVBQVFsRSxLQUFBK0MsTUFIWk8sRUFBQWEsdUJBQUEsRUFKQWIsRUFBTWMseUJBQTJCOUQsRUFBU04sS0FBSytDLFVBVy9DaEMsQ0FJWXVDLElBQUFBLEdBQ0FDLFVBQU9jLGFBRlg1QixNQUlLckMsRUFBQWxCLGNBQUF1RCxNQUNEYSxRQUFNYSxHQUtWYixFQUNBQSxpQkFBTWMsR0FkZDNELEtBQUEsU0FBQUgsSUFnQkgsSUFBQUEsRUFBQU4sS0FBQXNFLFNBRVdoQixFQWxDcEJpQixtQkFBQSxFQURKaEIsRUFBQWMsV0F3Q2VmLEVBQUFhLHVCQUFBLEVBRUhiLEVBQUFjLHlCQUFBOUQsRUFBQU4sS0FBQStDLFNBR1pyQyxNQUFBLFNBQUFzQyxHQUNzQk0sRUFBQWlCLG1CQUFNLEVBRW5CNUQsRUFBZVAseUJBQTZCcUMsT0FFekMvQixNQUlLLFNBQUFzQyxPQUtHUCxFQUFBQSxRQUNBeUIsS0FBQUEsR0FIa0JNLE9BQUEsSUFVZGxCLEVBQUFtQixjQUFJbkUsV0FDQWdELEVBQ0FDLGVBQUFBLEVBQUFyRSxjQUFBdUQsTUFBQWEsRUFBQWtCLFFBQ0gvRCxLQUFBLFNBQUFILEdBRUdnRCxHQUFBQSxFQUFBQSxLQUFNb0IsTUFDTnBCLEVBQUFBLGlCQUFNcUIsRUFDVHJCLEVBQUFxQixtQkFBQXJFLEVBQUFOLEtBQUErQyxXQUdETyxHQUFBQSxFQUFNb0IsS0FBQUEsUUFBTixDQUNBcEIsRUFBTXFCLGlCQUFOLEVBRVgsSUFBQUMsR0FFRVgsVUFBTyxTQUNKUyxNQUFBQSxFQUFOeEYsY0FBQXVELE1BQ01rQyxRQUFBQSxHQUlsQjVELEVBQ0FQLGlCQUF1Qk0sR0FFZEQsS0FBYUMsU0FBQUEsSUFFZSxJQUFQaUMsRUFBTy9DLEtBQUFzRSxTQUNmTyxFQUFBQSxpQkFBTixFQUNNQyxFQUFBQSxXQUlOeEIsRUFBa0JoRCxpQkFBbEIsRUFDSGdELEVBQUFxQixtQkFBQXJFLEVBQUFOLEtBQUErQyxTQUlLK0IsTUFBQUEsU0FBQUEsR0FkZHhCLEVBQUFvQixpQkFBQSxFQURKcEIsRUFBQXFCLG1CQUFBM0IsT0FxQklqQyxNQUNLRixTQUFBQSxHQUVPUCxFQUFBQSxpQkFBcUIsRUFDckJnRCxFQUFNeUIsbUJBQU4vQixLQU1ITSxFQUFBMEIsY0FBQSxTQUFBbEUsR0FDSkMsRUFFR3VDLGFBQU15QixFQUF1QjNFLEVBQTdCbEIsY0FBQXVELE9BQ0FhLEtBQU0yQixTQUFBQSxHQWRkM0UsRUFBQU4sS0FBQStDLE9BREpPLEVBQUF1QiwyQkFBQSxFQW1CS3pFLEVBQWVsQiw2QkFBOEJvQixFQUVyRE4sS0FBQStDLFFBSUpPLEVBQUF1QiwyQkFBQSxFQUNKdkIsRUFBQTRCLFVBQUE1RSxFQUFBTixLQUFBbUYsWUFqQ29CekUsTUFBTSxTQUFBc0MsR0FDSE0sRUFBTXVCLDJCQUE0QixFQUNsQ3ZCLEVBQU13Qiw2QkFBK0I5QixLQUtqRE0sRUFBTThCLGVBQWlCLFNBQUN0RSxHQUNwQkMsRUFDS0YsYUFBYUMsRUFBZ0JWLEVBQWVsQixjQUFjdUQsT0FDMURoQyxLQUFLLFNBQUFILEdBQ0VBLEVBQVNOLEtBQUsrQyxPQUNkTyxFQUFNeUIsc0JBQXVCLEVBQzdCekIsRUFBTTJCLHdCQUEwQjNFLEVBQVNOLEtBQUsrQyxRQUc5Q08sRUFBTXlCLHNCQUF1QixFQUM3QnpCLEVBQU0rQixXQUFhL0UsRUFBU04sS0FBS21GLFlBR3hDekUsTUFBTSxTQUFBc0MsR0FDSE0sRUFBTXlCLHNCQUF1QixFQUM3QnpCLEVBQU0yQix3QkFBMEJqQyxNQUl2QzVDLEVBQWVsQixjQUFjSyxhQUt0Q3FDLEVBQVVNLEtBQUssV0FyTHZCcEUsUUFDS0MsT0FBTyxVQUdadUgsV0FBWXRFLGNBQVdzRSxHQUV2QkEsRUFBU0EsU0FBWWxGLGlCQUFnQndCLFlBQVdiLFVBQWlCLFVBUnJFO0FIRkEsY0FFQSxXQVVLLFNBQUF3RSxFQUFBbkYsRUFBQXdCLElBUkQ5RCxRQUNLQyxPQUFPLFVBR1p3SCxXQUFZdkUsY0FBV3VFLEdBRXZCQSxFQUFTQSxTQUFZbkYsaUJBQWdCd0IsYUFSekM7QUlGQSxjQUVBLFdBUUksU0FBUzRELEVBQWlCcEYsRUFBZ0J3QixFQUFXTCxHQUdqRCxJQUFJbkIsRUFBQUEsS0FFQUEsRUFBSUEsYUFFbUIsVUFBbkJxRixFQUFPQyxjQUFZbkcsYUFBQWtHLEVBQW5CQyxXQUdBakcsS0FBQSxJQUtZZ0csRUFBQXhFLHNCQUFBLFdBQ0l3RSxFQUNBQSxzQkFBT0UsRUFBQUEsV0FGWGxGLEtBQUEsU0FBQUgsR0FLSW1GLEVBQU9HLEtBQUFBLE9BQ1BILEVBQU9JLG1CQUFQLEVBSkFKLEVBQU9FLHFCQUF1QnJGLEVBQVNOLEtBQUsrQyxRQVF4QzBDLEVBQU9LLG1CQUFQLEVBQ0RMLEVBRkhJLHVCQUFBLCtCQU1HRCxXQUFBQSxXQUNBRCxFQUFBQSxpQkFuQmYsUUF1QkpqRixNQUFBLFNBQUFzQyxHQUNPOEMsRUFBQUEsbUJBQXNCLEVBQ3pCdkUsRUFDS0oscUJBREw2QixLQVFZeUMsRUFBQUEsY0FBT00sV0FDUE4sRUFDSHRFLG1CQUVKVCxLQUFNLFNBQUFKLEdBQ0l5RixFQUFBQSxLQUFQaEQsT0FDT2lELEVBQUFBLGdCQUFQLEVBZFJQLEVBQUFPLGtCQUFBMUYsRUFBQU4sS0FBQStDLFFBa0JKMEMsRUFBQU0sZ0JBQUEsRUFDT0UsRUFBYUMsY0FBQzdFLEVBQWdCckIsS0FBQTBGLGFBS3JCUyxNQUFBQSxTQUFBQSxHQURKVixFQUdLTSxnQkFBQSxFQUNESyxFQUFBQSxrQkFBaUJwRCxLQU1yQm1ELEVBQUFBLFdBQUEsU0FBQTlFLEdBQ0hFLEVBZlRMLGdCQUFBRyxHQWtCQ1osS0FBQSxTQUFBSCxHQUNjQSxFQUFmTixLQUFBK0MsTUFDSG9ELE1BQUE3RixFQUFBTixLQUFBK0MsT0FJSnFELFdBQUEsV0FDSlgsRUFBQUssaUJBekZMLE9BNkV5QnBGLE1BQU0sU0FBQXNDLEdBQ0htRCxNQUFNbkQsT0FLbEJwQixFQUFVTSxLQUFLLFlBSW5CTixFQUFVTSxLQUFLLFdBckZ2QnBFLFFBQ0tDLE9BQU8sVUFHWnlILFdBQUFBLG1CQUE0QkEsR0FFNUJBLEVBQVNBLFNBQWlCcEYsaUJBQWdCd0IsWUFBV0wsa0JBUnpEIiwiZmlsZSI6ImFwcC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKlxufC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbnwgc2V0dGluZyB1cCBlbnRyeSBwb2ludCBmb3IgYW5ndWxhciBmcm9udC1lbmRcbnwgQGF1dGhvcjogamFoaWQgaGFxdWUgPGphaGlkLmhhcXVlQHlhaG9vLmNvbT5cbnwgQGNvcHlyaWdodDogbmJhLXNscCwgMjAxN1xufC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiovXG5cbid1c2Ugc3RyaWN0JztcblxuKGZ1bmN0aW9uICgpIHtcbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ25iYXNscCcsIFsnbmdSZXNvdXJjZScsICduZ1JvdXRlJ10pXG4gICAgICAgIC5jb25maWcoWyckcm91dGVQcm92aWRlcicsICckbG9jYXRpb25Qcm92aWRlcicsIGNvbmZpZ10pO1xuXG4gICAgZnVuY3Rpb24gY29uZmlnKCRyb3V0ZVByb3ZpZGVyLCAkbG9jYXRpb25Qcm92aWRlcikge1xuICAgICAgICAkcm91dGVQcm92aWRlclxuICAgICAgICAgICAgLndoZW4oJy8nLCB7XG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdob21lL3dlbGNvbWUvd2VsY29tZS52aWV3Lmh0bWwnLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICd3ZWxjb21lQ3RybCcsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlckFzOiAnd3ZtJyxcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAud2hlbignL3NpZ251cCcsIHtcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3NpZ251cC9zaWdudXAudmlldy5odG1sJyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnc2lnbnVwQ3RybCcsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlckFzOiAncmVndm0nLFxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC53aGVuKCcvc2lnbmluJywge1xuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnc2lnbmluL3NpZ25pbi52aWV3Lmh0bWwnLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdzaWduaW5DdHJsJyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyQXM6ICdsdm0nLFxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC53aGVuKCcvcHJvZmlsZScsIHtcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3Byb2ZpbGUvcHJvZmlsZS52aWV3Lmh0bWwnLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdwcm9maWxlQ3RybCcsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlckFzOiAncHJvdm0nLFxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC53aGVuKCcvaGVscCcsIHtcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2hlbHAvaGVscC52aWV3Lmh0bWwnLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdoZWxwQ3RybCcsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlckFzOiAnaHZtJyxcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAud2hlbignL3NpdGVjb250cm9sbCcsIHtcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2FkbWluL3NpdGVjb250cm9sbC9zaXRlY29udHJvbGwudmlldy5odG1sJyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnc2l0ZWNvbnRyb2xsQ3RybCcsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlckFzOiAnYWRTaXRlJyxcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAud2hlbignL3dlbGNvbWUnLCB7XG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd3ZWxjb21lL3dlbGNvbWUudmlldy5odG1sJyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnd2VsY29tZUN0cmwnLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ3d2bScsXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAkbG9jYXRpb25Qcm92aWRlci5odG1sNU1vZGUoe1xuICAgICAgICAgICAgZW5hYmxlZDogdHJ1ZSxcbiAgICAgICAgfSk7XG4gICAgfVxufSkoKTtcbiIsIi8qXG58LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxufCBzZXR0aW5nIHVwIGF1dGhlbnRpY2F0aW9uIHNlcnZpY2UgXG58IEBhdXRob3I6IGphaGlkIGhhcXVlIDxqYWhpZC5oYXF1ZUB5YWhvby5jb20+XG58IEBjb3B5cmlnaHQ6IG5iYS1zbHAsIDIwMTdcbnwtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4qL1xuXG4ndXNlIHN0cmljdCc7XG5cbmFuZ3VsYXJcbiAgICAubW9kdWxlKCduYmFzbHAnKVxuICAgIC5zZXJ2aWNlKCdhdXRoZW50aWNhdGlvbicsIGF1dGhlbnRpY2F0aW9uKTtcblxuYXV0aGVudGljYXRpb24uJGluamVjdCA9IFsnJHdpbmRvdycsICckaHR0cCddO1xuXG5mdW5jdGlvbiBhdXRoZW50aWNhdGlvbigkd2luZG93LCAkaHR0cCkge1xuLy8gc2F2aW5nIHRva2VuLlxuICAgIGNvbnN0IHNhdmVUb2tlbiA9XHRmdW5jdGlvbiAodG9rZW4pIHtcbiAgICAgICAgJHdpbmRvdy5sb2NhbFN0b3JhZ2VbJ25iYXNscCddID0gdG9rZW47XG4gICAgfTtcblxuICAgIGNvbnN0IGdldFRva2VuID1cdGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuICR3aW5kb3cubG9jYWxTdG9yYWdlWyduYmFzbHAnXTtcbiAgICB9O1xuXG4gICAgY29uc3QgaXNMb2dnZWRJbiA9ICgpID0+IHtcbiAgICAgICAgY29uc3QgdG9rZW4gPSBnZXRUb2tlbigpO1xuICAgICAgICBsZXQgcGF5bG9hZDtcblxuICAgICAgICBpZiAodG9rZW4pIHtcbiAgICAgICAgICAgIHBheWxvYWQgPSB0b2tlbi5zcGxpdCgnLicpWzFdO1xuICAgICAgICAgICAgcGF5bG9hZCA9ICR3aW5kb3cuYXRvYihwYXlsb2FkKTtcbiAgICAgICAgICAgIHBheWxvYWQgPSBKU09OLnBhcnNlKHBheWxvYWQpO1xuICAgICAgICAgICAgcmV0dXJuIHBheWxvYWQ7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgY29uc3QgY3VycmVudFVzZXIgPSAoKSA9PiB7XG4gICAgICAgIGlmIChpc0xvZ2dlZEluKSB7XG4gICAgICAgICAgICBjb25zdCB0b2tlbiA9IGdldFRva2VuKCk7XG4gICAgICAgICAgICBsZXQgcGF5bG9hZCA9IHRva2VuLnNwbGl0KCcuJylbMV07XG4gICAgICAgICAgICBwYXlsb2FkID0gJHdpbmRvdy5hdG9iKHBheWxvYWQpO1xuICAgICAgICAgICAgcGF5bG9hZCA9IEpTT04ucGFyc2UocGF5bG9hZCk7XG5cbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdXNlcklkOiBwYXlsb2FkLl9pZCxcbiAgICAgICAgICAgICAgICBlbWFpbDogcGF5bG9hZC5lbWFpbCxcbiAgICAgICAgICAgICAgICBhY2NvdW50U3RhdHVzOiBwYXlsb2FkLmFjY291bnRTdGF0dXMsXG4gICAgICAgICAgICAgICAgYWNjb3VudFR5cGU6IHBheWxvYWQuYWNjb3VudFR5cGUsXG4gICAgICAgICAgICAgICAgYWNjb3VudElkOiBwYXlsb2FkLnVzZXJJZCxcbiAgICAgICAgICAgICAgICBuYW1lOiBwYXlsb2FkLm5hbWUsXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIGNvbnN0IExvZ291dCA9ICgpID0+IHtcbiAgICAgICAgJHdpbmRvdy5sb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbSgnbmJhc2xwJyk7XG4gICAgfTtcblxuICAgIGNvbnN0IHNpZ25VcCA9ICh1c2VyKSA9PiB7XG4gICAgICAgIHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL3NpZ251cCcsIHVzZXIpLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIHNhdmVUb2tlbihkYXRhLnRva2VuKTtcbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgIGNvbnN0IHNpZ25JbiA9ICh1c2VyKSA9PiB7XG4gICAgICAgIHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL3NpZ25pbicsIHVzZXIpLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIHNhdmVUb2tlbihkYXRhLnRva2VuKTtcbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgIGNvbnN0IGhhbmRsZVN1Y2Nlc3MgPSAocmVzcG9uc2UpID0+IHJlc3BvbnNlO1xuXG4gICAgY29uc3QgaGFuZGxlRXJyb3IgPSAocmVzcG9uc2UpID0+IHJlc3BvbnNlO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgY3VycmVudFVzZXI6IGN1cnJlbnRVc2VyLFxuICAgICAgICBzYXZlVG9rZW46IHNhdmVUb2tlbixcbiAgICAgICAgZ2V0VG9rZW46IGdldFRva2VuLFxuICAgICAgICBpc0xvZ2dlZEluOiBpc0xvZ2dlZEluLFxuICAgICAgICBzaWduVXA6IHNpZ25VcCxcbiAgICAgICAgc2lnbkluOiBzaWduSW4sXG4gICAgICAgIExvZ291dDogTG9nb3V0LFxuICAgIH07XG59XG5cbiIsIi8qXG58LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxufCBzZXR0aW5nIHVwIGFjY291bnQgc2VydmljZSBmb3IgYXBwXG58IEBhdXRob3I6IGphaGlkIGhhcXVlIDxqYWhpZC5oYXF1ZUB5YWhvby5jb20+XG58IEBjb3B5cmlnaHQ6IG5iYS1zbHAsIDIwMTdcbnwtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4qL1xuXG4ndXNlIHN0cmljdCc7XG5cbihmdW5jdGlvbiAoKSB7XG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCduYmFzbHAnKVxuICAgICAgICAuc2VydmljZSgnYWNjb3VudCcsIGFjY291bnQpO1xuXG4gICAgYWNjb3VudC4kaW5qZWN0ID0gWyckd2luZG93JywgJyRodHRwJ107XG5cbiAgICBmdW5jdGlvbiBhY2NvdW50KCR3aW5kb3csICRodHRwKSB7XG5cbiAgICAgICAgY29uc3QgZ2V0QWNjb3VudFN0YXR1c2VzID0gKHVzZXJJZCkgPT4ge1xuICAgICAgICAgICAgcmV0dXJuICRodHRwIFxuICAgICAgICAgICAgICAgIC5nZXQoJy9hcGkvJyArIHVzZXJJZCArICcvc3RhdHVzZXMnKVxuICAgICAgICAgICAgICAgIC50aGVuKGhhbmRsZVN1Y2Nlc3MpXG4gICAgICAgICAgICAgICAgLmNhdGNoKGhhbmRsZUVycm9yKTtcbiAgICAgICAgfTtcblxuICAgICAgICBjb25zdCB1cGRhdGVVc2VyU3RhdHVzID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIHJldHVybiAkaHR0cFxuICAgICAgICAgICAgICAgIC5wb3N0KCcvYXBpL3VzZXJzdGF0dXMnLCBkYXRhKVxuICAgICAgICAgICAgICAgIC50aGVuKGhhbmRsZVN1Y2Nlc3MpXG4gICAgICAgICAgICAgICAgLmNhdGNoKGhhbmRsZUVycm9yKTtcbiAgICAgICAgfTtcblxuICAgICAgICBjb25zdCBzYXZlQmFzaWNJbmZvID0gKGRhdGEpID0+IHtcbiAgICAgICAgICAgIHJldHVybiAkaHR0cCBcbiAgICAgICAgICAgICAgICAucG9zdCgnL2FwaS9jcmVhdGViYXNpY3Byb2ZpbGUnLCBkYXRhKVxuICAgICAgICAgICAgICAgIC50aGVuKGhhbmRsZVN1Y2Nlc3MpXG4gICAgICAgICAgICAgICAgLmNhdGNoKGhhbmRsZUVycm9yKTtcbiAgICAgICAgfTtcblxuICAgICAgICBjb25zdCBzYXZlQnJhbmNoSW5mbyA9ICh1c2VySWQsIGRhdGEpID0+IHtcbiAgICAgICAgICAgIHJldHVybiAkaHR0cFxuICAgICAgICAgICAgICAgIC5wb3N0KCcvYXBpLycgKyB1c2VySWQgKyAnL3NhdmVicmFuY2hpbmZvJywgZGF0YSlcbiAgICAgICAgICAgICAgICAudGhlbihoYW5kbGVTdWNjZXNzKVxuICAgICAgICAgICAgICAgIC5jYXRjaChoYW5kbGVFcnJvcik7XG4gICAgICAgIH07XG5cbiAgICAgICAgLypcbiAgICAgICAgfC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAgICAgfCBGb2xsb3dpbmcgZnVuY3Rpb24gd2lsbCBsb2FkIGFsbCBkYXRhIGZvciB1c2VyXG4gICAgICAgIHwgYmFzZWQgb24gZ2l2ZW4gdXNlckVtYWlsIGFuZCBjb2xsZWN0aW9uIG5hbWVcbiAgICAgICAgfC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAgICAgKi9cbiAgICAgICAgY29uc3QgbG9hZFVzZXJJbmZvID0gKGNvbGxlY3Rpb25OYW1lLCB1c2VySWQpID0+IHtcbiAgICAgICAgICAgIHJldHVybiAkaHR0cCBcbiAgICAgICAgICAgICAgICAuZ2V0KCcvYXBpLycgKyB1c2VySWQgKyAnLycgKyBjb2xsZWN0aW9uTmFtZSArICcvdXNlcmluZm8nKVxuICAgICAgICAgICAgICAgIC50aGVuKGhhbmRsZVN1Y2Nlc3MpXG4gICAgICAgICAgICAgICAgLmNhdGNoKGhhbmRsZUVycm9yKTtcbiAgICAgICAgfTtcblxuICAgICAgICBjb25zdCBoYW5kbGVTdWNjZXNzID0gKHJlc3BvbnNlKSA9PiByZXNwb25zZTtcblxuICAgICAgICBjb25zdCBoYW5kbGVFcnJvciA9IChyZXNwb25zZSkgPT4gcmVzcG9uc2U7XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGdldEFjY291bnRTdGF0dXNlczogZ2V0QWNjb3VudFN0YXR1c2VzLFxuICAgICAgICAgICAgdXBkYXRlVXNlclN0YXR1czogdXBkYXRlVXNlclN0YXR1cyxcbiAgICAgICAgICAgIHNhdmVCYXNpY0luZm86IHNhdmVCYXNpY0luZm8sXG4gICAgICAgICAgICBzYXZlQnJhbmNoSW5mbzogc2F2ZUJyYW5jaEluZm8sXG4gICAgICAgICAgICBsb2FkVXNlckluZm86IGxvYWRVc2VySW5mbyxcbiAgICAgICAgfTtcbiAgICB9XG5cbn0pKCk7XG4iLCIvKlxufC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbnwgc2V0dGluZyB1cCBzZXJ2aWNlIGZvciBzaXRlLWNvbnRyb2xsZXIgZm9yIGFkbWluXG58IEBhdXRob3I6IGphaGlkIGhhcXVlIDxqYWhpZC5oYXF1ZUB5YWhvby5jb20+XG58IEBjb3B5cmlnaHQ6IG5iYS1zbHAsIDIwMThcbnwtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4qL1xuXG4ndXNlIHN0cmljdCc7XG5cbihmdW5jdGlvbiAoKSB7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ25iYXNscCcpXG4gICAgICAgIC5zZXJ2aWNlKCdzaXRlY29udHJvbGxlcicsIHNpdGVjb250cm9sbGVyKTtcblxuICAgIHNpdGVjb250cm9sbGVyLiRpbmplY3QgPSBbJyRodHRwJ107XG5cbiAgICBmdW5jdGlvbiBzaXRlY29udHJvbGxlcigkaHR0cCkge1xuICAgICAgICBcbiAgICAgICAgY29uc3QgYWRkUHJlZmVycmVkQ29tbWl0dGVlID0gKGRhdGEpID0+IHtcbiAgICAgICAgICAgIHJldHVybiAkaHR0cFxuICAgICAgICAgICAgICAgIC5wb3N0KCcvYXBpL2NyZWF0ZWNvbW1pdHRlZScsIGRhdGEpXG4gICAgICAgICAgICAgICAgLnRoZW4oaGFuZGxlU3VjY2VzcylcbiAgICAgICAgICAgICAgICAuY2F0Y2goaGFuZGxlRXJyb3IpO1xuICAgICAgICB9O1xuXG4gICAgICAgIGNvbnN0IHNob3dBbGxDb21taXR0ZWUgPSAoKSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gJGh0dHBcbiAgICAgICAgICAgICAgICAuZ2V0KCcvYXBpL3Nob3djb21taXR0ZWUnKVxuICAgICAgICAgICAgICAgIC50aGVuKGhhbmRsZVN1Y2Nlc3MpXG4gICAgICAgICAgICAgICAgLmNhdGNoKGhhbmRsZUVycm9yKTtcbiAgICAgICAgfTtcblxuICAgICAgICBjb25zdCByZW1vdmVDb21taXR0ZWUgPSAoY29tbWl0dGVlSWQpID0+IHtcbiAgICAgICAgICAgIHJldHVybiAkaHR0cCBcbiAgICAgICAgICAgICAgICAuZGVsZXRlKCcvYXBpLycgKyBjb21taXR0ZWVJZCArICcvcmVtb3ZlY29tbWl0dGVlJylcbiAgICAgICAgICAgICAgICAudGhlbihoYW5kbGVTdWNjZXNzKVxuICAgICAgICAgICAgICAgIC5jYXRjaChoYW5kbGVFcnJvcik7XG4gICAgICAgIH07XG5cbiAgICAgICAgY29uc3QgaGFuZGxlU3VjY2VzcyA9IChyZXNwb25zZSkgPT4gcmVzcG9uc2U7XG5cbiAgICAgICAgY29uc3QgaGFuZGxlRXJyb3IgPSAocmVzcG9uc2UpID0+IHJlc3BvbnNlO1xuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBhZGRQcmVmZXJyZWRDb21taXR0ZWU6IGFkZFByZWZlcnJlZENvbW1pdHRlZSxcbiAgICAgICAgICAgIHNob3dBbGxDb21taXR0ZWU6IHNob3dBbGxDb21taXR0ZWUsXG4gICAgICAgICAgICByZW1vdmVDb21taXR0ZWU6IHJlbW92ZUNvbW1pdHRlZSxcbiAgICAgICAgfTtcblxuICAgIH1cblxufSkoKTtcbiIsIi8qXG58LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxufCBzZXR0aW5nIHVwIG5hdmlnYXRpb24gZGlyZWN0aXZlIGZvciB0aGUgYXBwXG58IEBhdXRob3I6IGphaGlkIGhhcXVlIDxqYWhpZC5oYXF1ZUB5YWhvby5jb20+XG58IEBjb3B5cmlnaHQ6IG5iYXNscCwgMjAxN1xufC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiovXG5cbid1c2Ugc3RyaWN0JztcblxuKGZ1bmN0aW9uICgpIHtcbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ25iYXNscCcpXG4gICAgICAgIC5kaXJlY3RpdmUoJ3NpdGVOYXYnLCBzaXRlTmF2KTtcblxuICAgIGZ1bmN0aW9uIHNpdGVOYXYoKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICByZXN0cmljdDogJ0VBJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnY29tbW9uL2RpcmVjdGl2ZXMvbmF2L3NpdGUtbmF2LnRlbXBsYXRlLmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ25hdkN0cmwgYXMgbnZtJyxcbiAgICAgICAgfTtcbiAgICB9XG59KSgpO1xuIiwiLypcbnwtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG58IHNldHRpbmcgdXAgY29udHJvbGxlciBmb3IgbmF2aWdhdGlvblxufCBAYXV0aG9yOiBqYWhpZCBoYXF1ZSA8amFoaWQuaGFxdWVAeWFob28uY29tPlxufCBAY29weXJpZ2h0OiBuYmFzbHAsIDIwMTdcbnwtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4qL1xuXG4ndXNlIHN0cmljdCc7XG5cbihmdW5jdGlvbiAoKSB7XG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCduYmFzbHAnKVxuICAgICAgICAuY29udHJvbGxlcignbmF2Q3RybCcsIG5hdkN0cmwpO1xuXG4gICAgbmF2Q3RybC4kaW5qZWN0ID0gWydhdXRoZW50aWNhdGlvbicsICckbG9jYXRpb24nXTtcblxuICAgIGZ1bmN0aW9uIG5hdkN0cmwoYXV0aGVudGljYXRpb24sICRsb2NhdGlvbikge1xuICAgICAgICBjb25zdCBudm0gPSB0aGlzO1xuXG4gICAgICAgIGlmIChhdXRoZW50aWNhdGlvbi5pc0xvZ2dlZEluKCkpIHtcbiAgICAgICAgICAgIG52bS5sb2dnZWRJblVyaSA9IHRydWU7XG4gICAgICAgICAgICBudm0ubG9nZ2VkSW5OYW1lID0gYXV0aGVudGljYXRpb24uY3VycmVudFVzZXIoKS5uYW1lO1xuXG4gICAgICAgICAgICBudm0uY3VycmVudEFjY291bnRUeXBlID0gYXV0aGVudGljYXRpb24uY3VycmVudFVzZXIoKS5hY2NvdW50VHlwZTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKG52bS5jdXJyZW50QWNjb3VudFR5cGUpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgbnZtLmxvZ2dlZEluVXJpID0gZmFsc2U7XG4gICAgICAgIH1cblxuICAgICAgICBudm0ubG9nb3V0ID0gKCkgPT4ge1xuICAgICAgICAgICAgYXV0aGVudGljYXRpb24uTG9nb3V0KCk7XG4gICAgICAgICAgICAkbG9jYXRpb24ucGF0aCgnL3NpZ25pbicpO1xuICAgICAgICB9O1xuICAgIH1cbn0pKCk7XG4iLCIvKlxufC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbnwgc2V0dGluZyB1cCBmb290ZXIgZGlyZWN0aXZlIGZvciBhcHBsaWNhdGlvblxufCBAYXV0aG9yOiBqYWhpZCBoYXF1ZSA8amFoaWQuaGFxdWVAeWFob28uY29tPlxufCBAY29weXJpZ2h0OiBuYmFzbHAsIDIwMTdcbnwtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4qL1xuXG4ndXNlIHN0cmljdCc7XG5cbihmdW5jdGlvbiAoKSB7XG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCduYmFzbHAnKVxuICAgICAgICAuZGlyZWN0aXZlKCdzaXRlRm9vdGVyJywgc2l0ZUZvb3Rlcik7XG4gICAgZnVuY3Rpb24gc2l0ZUZvb3RlcigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnRUEnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdjb21tb24vZGlyZWN0aXZlcy9mb290ZXIvZm9vdGVyLnRlbXBsYXRlLmh0bWwnLFxuICAgICAgICB9O1xuICAgIH1cbn0pKCk7XG4iLCIvKlxufC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbnwgc2V0dGluZyB1cCBjb250cm9sbGVyIGZvciB3ZWxjb21lIHBhZ2VcbnwgQGF1dGhvcjogamFoaWQgaGFxdWUgPGphaGlkLmhhcXVlQHlhaG9vLmNvbT5cbnwgQGNvcHlyaWdodDogbmJhc2xwLCAyMDE3XG58LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuKi9cblxuJ3VzZSBzdHJpY3QnO1xuXG4oZnVuY3Rpb24gKCkge1xuICAgIFxuICAgIGFuZ3VsYXIgXG4gICAgICAgIC5tb2R1bGUoJ25iYXNscCcpXG4gICAgICAgIC5jb250cm9sbGVyKCd3ZWxjb21lQ3RybCcsIHdlbGNvbWVDdHJsKTtcblxuICAgIHdlbGNvbWVDdHJsLiRpbmplY3QgPSBbJ2F1dGhlbnRpY2F0aW9uJywgJyRsb2NhdGlvbiddO1xuXG4gICAgZnVuY3Rpb24gd2VsY29tZUN0cmwoYXV0aGVudGljYXRpb24sICRsb2NhdGlvbikge1xuICAgICAgICBjb25zdCB3dm0gPSB0aGlzO1xuICAgIH1cblxufSkoKTtcbiIsIi8qXG58LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxufCBzZXR0aW5nIHVwIHNpZ251cCBjb250cm9sbGVyIGZvciB0aGUgYXBwXG58IEBhdXRob3I6IGphaGlkIGhhcXVlIDxqYWhpZC5oYXF1ZUB5YWhvby5jb20+XG58IEBjb3B5cmlnaHQ6IG5iYXNscCwgMjAxN1xufC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiovXG5cbid1c2Ugc3RyaWN0JztcblxuKGZ1bmN0aW9uICgpIHtcbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ25iYXNscCcpXG4gICAgICAgIC5jb250cm9sbGVyKCdzaWdudXBDdHJsJywgc2lnbnVwQ3RybCk7XG5cbiAgICBzaWdudXBDdHJsLiRpbmplY3QgPSBbJ2F1dGhlbnRpY2F0aW9uJywgJyRsb2NhdGlvbiddO1xuXG4gICAgZnVuY3Rpb24gc2lnbnVwQ3RybChhdXRoZW50aWNhdGlvbiwgJGxvY2F0aW9uKSB7XG4gICAgICAgIGNvbnN0IHJlZ3ZtID0gdGhpcztcblxuICAgICAgICAvLyB1c2VyIG9iamVjdC5cbiAgICAgICAgcmVndm0udXNlciA9IHtcbiAgICAgICAgICAgIGZpcnN0TmFtZTogJycsXG4gICAgICAgICAgICBsYXN0TmFtZTogJycsXG4gICAgICAgICAgICBkaXNwbGF5TmFtZTogJycsXG4gICAgICAgICAgICBlbWFpbDogJycsXG4gICAgICAgICAgICBwYXNzd29yZDogJycsXG4gICAgICAgICAgICBjb25maXJtUGFzc3dvcmQ6ICcnLFxuICAgICAgICB9O1xuXG4gICAgICAgIHJlZ3ZtLnJlZ2lzdGVyID0gKCkgPT4ge1xuICAgICAgICAgICAgYXV0aGVudGljYXRpb25cbiAgICAgICAgICAgICAgICAuc2lnblVwKHJlZ3ZtLnVzZXIpXG4gICAgICAgICAgICAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5kYXRhLmVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWd2bS5SZWdpc3RyYXRpb25FcnJvciA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWd2bS5SZWdpc3RyYXRpb25FcnJvck1zZyA9IHJlc3BvbnNlLmRhdGEuZXJyb3I7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWd2bS5SZWdpc3RyYXRpb25FcnJvciA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoJy93ZWxjb21lJyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlZ3ZtLlJlZ2lzdHJhdGlvbkVycm9yID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlZ3ZtLlJlZ2lzdHJhdGlvbkVycm9yTXNnID0gZXJyLmRhdGEuZXJyb3I7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcblxuICAgICAgICBpZiAoYXV0aGVudGljYXRpb24uaXNMb2dnZWRJbigpKSB7XG4gICAgICAgICAgICAkbG9jYXRpb24ucGF0aCgnL3dlbGNvbWUnKTtcbiAgICAgICAgfVxuICAgIH1cbn0pKCk7XG4iLCIvKlxufC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbnwgc2V0dGluZyB1cCBjb250cm9sbGVyIGZvciBsb2dpbiBwYWdlXG58IEBhdXRob3I6IGphaGlkIGhhcXVlIDxqYWhpZC5oYXF1ZUB5YWhvby5jb20+XG58IEBjb3B5cmlnaHQ6IG5iYXNscCwgMjAxN1xufC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiovXG5cbid1c2Ugc3RyaWN0JztcblxuKGZ1bmN0aW9uICgpIHtcbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ25iYXNscCcpXG4gICAgICAgIC5jb250cm9sbGVyKCdzaWduaW5DdHJsJywgc2lnbmluQ3RybCk7XG5cbiAgICBzaWduaW5DdHJsLiRpbmplY3QgPSBbJ2F1dGhlbnRpY2F0aW9uJywgJyRsb2NhdGlvbiddO1xuXG4gICAgZnVuY3Rpb24gc2lnbmluQ3RybChhdXRoZW50aWNhdGlvbiwgJGxvY2F0aW9uKSB7XG4gICAgICAgIGNvbnN0IGx2bSA9IHRoaXM7XG5cbiAgICAgICAgbHZtLnVzZXIgPSB7XG4gICAgICAgICAgICBlbWFpbDogJycsXG4gICAgICAgICAgICBwYXNzd29yZDogJycsXG4gICAgICAgIH07IFxuXG4gICAgICAgIGlmIChhdXRoZW50aWNhdGlvbi5pc0xvZ2dlZEluKCkpIHtcbiAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKCcvd2VsY29tZScpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgbHZtLmxvZ2luID0gKCkgPT4ge1xuICAgICAgICAgICAgICAgIGlmICghbHZtLnVzZXIuZW1haWwgfHwgIWx2bS51c2VyLnBhc3N3b3JkKSB7XG4gICAgICAgICAgICAgICAgICAgIGx2bS5sb2dpbkVycm9yID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgbHZtLmxvZ2luRXJyb3JNc2cgPSBgRXJyb3IhIGFsbCAqIGZpZWxkcyBhcmUgcmVxdWlyZWRgO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgbHZtLmxvZ2luRXJyb3IgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgbHZtLmRvTG9naW4oKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBsdm0uZG9Mb2dpbiA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICBhdXRoZW50aWNhdGlvblxuICAgICAgICAgICAgICAgICAgICAuc2lnbkluKGx2bS51c2VyKVxuICAgICAgICAgICAgICAgICAgICAuZXJyb3IoKGVycikgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgbHZtLmxvZ2luRXJyb3IgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgbHZtLmxvZ2luRXJyb3JNc2cgPSBlcnIuZXJyb3I7XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKCcvd2VsY29tZScpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG5cbn0pKCk7XG4iLCIvKlxufC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbnwgc2V0dGluZyB1cCBjb250cm9sbGVyIGZvciBwcm9maWxlIHBhZ2VcbnwgQGF1dGhvcjogamFoaWQgaGFxdWUgPGphaGlkLmhhcXVlQHlhaG9vLmNvbT5cbnwgQGNvcHlyaWdodDogbmJhLXNscCwgMjAxN1xufC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiovXG5cbid1c2Ugc3RyaWN0JztcblxuKGZ1bmN0aW9uICgpIHtcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnbmJhc2xwJylcbiAgICAgICAgLmNvbnRyb2xsZXIoJ3Byb2ZpbGVDdHJsJywgcHJvZmlsZUN0cmwpO1xuXG4gICAgcHJvZmlsZUN0cmwuJGluamVjdCA9IFsnYXV0aGVudGljYXRpb24nLCAnJGxvY2F0aW9uJywgJ2FjY291bnQnLCAnJHJvdXRlJ107XG5cbiAgICBmdW5jdGlvbiBwcm9maWxlQ3RybChhdXRoZW50aWNhdGlvbiwgJGxvY2F0aW9uLCBhY2NvdW50LCAkcm91dGUpIHtcblxuICAgICAgICBjb25zdCBwcm92bSA9IHRoaXM7XG5cbiAgICAgICAgaWYgKGF1dGhlbnRpY2F0aW9uLmlzTG9nZ2VkSW4oKSkge1xuICAgICAgICAgICAgcHJvdm0ucHJvZmlsZVN0YXR1cyA9IGF1dGhlbnRpY2F0aW9uLmN1cnJlbnRVc2VyKCkuYWNjb3VudFN0YXR1cztcblxuICAgICAgICAgICAgcHJvdm0uY3VycmVudEFjY291bnRUeXBlID0gYXV0aGVudGljYXRpb24uY3VycmVudFVzZXIoKS5hY2NvdW50VHlwZTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gY2hlY2tpbmcgYWNjb3VudCB0eXBlXG4gICAgICAgICAgICBpZiAoYXV0aGVudGljYXRpb24uY3VycmVudFVzZXIoKS5hY2NvdW50VHlwZSA9PT0gJ2N1c3RvbWVyJykge1xuXG4gICAgICAgICAgICAgICAgLy8gZ2V0IHVzZXIgYWNjb3VudCBzdGF0dWVzIFxuICAgICAgICAgICAgICAgIHByb3ZtLmdldFByb2ZpbGVTdGF0dXNlcyA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgYWNjb3VudFxuICAgICAgICAgICAgICAgICAgICAgICAgLmdldEFjY291bnRTdGF0dXNlcyhhdXRoZW50aWNhdGlvbi5jdXJyZW50VXNlcigpLmVtYWlsKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4ocmVzcG9uc2UgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5kYXRhLmVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb3ZtLnN0YXR1c0xvYWRFcnJvciA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb3ZtLnN0YXR1c0xvYWRFcnJvck1zZyA9IHJlc3BvbnNlLmRhdGEuZXJyb3I7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm92bS5zdGF0dXNMb2FkRXJyb3IgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvdm0udXNlclN0YXR1c2VzID0gcmVzcG9uc2UuZGF0YS5zdGF0dXNlcztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLmNhdGNoKGVyciA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvdm0uc3RhdHVzTG9hZEVycm9yID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm92bS5zdGF0dXNMb2FkRXJyb3JNc2cgPSBlcnI7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgLy8gc2F2aW5nIGJhc2ljIHByb2ZpbGUgaW5mb1xuICAgICAgICAgICAgICAgIHByb3ZtLmJhc2ljUHJvZmlsZSA9IHtcbiAgICAgICAgICAgICAgICAgICAgd2hvczogYXV0aGVudGljYXRpb24uY3VycmVudFVzZXIoKS5lbWFpbCxcbiAgICAgICAgICAgICAgICAgICAgdXNlcklkOiBhdXRoZW50aWNhdGlvbi5jdXJyZW50VXNlcigpLnVzZXJJZCxcbiAgICAgICAgICAgICAgICAgICAgZm9ybWVyTmFtZTogJycsXG4gICAgICAgICAgICAgICAgICAgIHNleDogJycsXG4gICAgICAgICAgICAgICAgICAgIHRlbGU6ICcnLFxuICAgICAgICAgICAgICAgICAgICBhZGRyZXNzOiAnJyxcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgcHJvdm0uc2F2ZUJhc2ljSW5mbyA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgYWNjb3VudFxuICAgICAgICAgICAgICAgICAgICAgICAgLnNhdmVCYXNpY0luZm8ocHJvdm0uYmFzaWNQcm9maWxlKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEuZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvdm0uYmFzaWNBY2NvdW50SW5mb0Vycm9yID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvdm0uYmFzaWNBY2NvdW50SW5mb0Vycm9yTXNnID0gcmVzcG9uc2UuZGF0YS5lcnJvcjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB1cGRhdGVkU3RhdHVzID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlX2F0OiAnYmFzaWNfaW5mbycsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbWFpbDogYXV0aGVudGljYXRpb24uY3VycmVudFVzZXIoKS5lbWFpbCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXR1czogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjYWxsaW5nIHNlcnZpY2UgZnVuY3Rpb24uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC51cGRhdGVVc2VyU3RhdHVzKHVwZGF0ZWRTdGF0dXMpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihyZXNwb25zZSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEudXBkYXRlZCA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm92bS5zdGF0dXNVcGRhdGVFcnJvciA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcm91dGUucmVsb2FkKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm92bS5iYXNpY0FjY291bnRJbmZvRXJyb3IgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm92bS5iYXNpY0FjY291bnRJbmZvRXJyb3JNc2cgPSByZXNwb25zZS5kYXRhLmVycm9yO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY2F0Y2goZXJyID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm92bS5zdGF0dXNVcGRhdGVFcnJvciA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvdm0uYmFzaWNBY2NvdW50SW5mb0Vycm9yTXNnID0gZXJyO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICBwcm92bS5icmFuY2ggPSB7XG4gICAgICAgICAgICAgICAgICAgIHllYXI6ICcnLFxuICAgICAgICAgICAgICAgICAgICBicmFuY2g6ICcnLFxuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAvLyBhZGRpbmcgYnJhbmNoIGluZm9cbiAgICAgICAgICAgICAgICBwcm92bS5zYXZlQmF0Y2hJbmZvID0gKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBhY2NvdW50XG4gICAgICAgICAgICAgICAgICAgICAgICAuc2F2ZUJyYW5jaEluZm8oYXV0aGVudGljYXRpb24uY3VycmVudFVzZXIoKS5lbWFpbCwgcHJvdm0uYnJhbmNoKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4ocmVzcG9uc2UgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5kYXRhLmVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb3ZtLmJyYW5jaEluZm9FcnJvciA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb3ZtLmJyYW5jaEluZm9FcnJvck1zZyA9IHJlc3BvbnNlLmRhdGEuZXJyb3I7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKHJlc3BvbnNlLmRhdGEuc3VjY2Vzcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm92bS5icmFuY2hJbmZvRXJyb3IgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHVwZGF0ZWRTdGF0dXMgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGVfYXQ6ICdicmFuY2gnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW1haWw6IGF1dGhlbnRpY2F0aW9uLmN1cnJlbnRVc2VyKCkuZW1haWwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0dXM6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gY2FsbGluZyBzZXJ2aWNlIGZ1bmN0aW9uLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAudXBkYXRlVXNlclN0YXR1cyh1cGRhdGVkU3RhdHVzKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4ocmVzcG9uc2UgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5kYXRhLnVwZGF0ZWQgPT09IHRydWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvdm0uYnJhbmNoSW5mb0Vycm9yID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyb3V0ZS5yZWxvYWQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb3ZtLmJyYW5jaEluZm9FcnJvciA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb3ZtLmJyYW5jaEluZm9FcnJvck1zZyA9IHJlc3BvbnNlLmRhdGEuZXJyb3I7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5jYXRjaChlcnIgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb3ZtLmJyYW5jaEluZm9FcnJvciA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvdm0uYnJhbmNoSW5mb0Vycm9yTXNnID0gZXJyO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5jYXRjaChlcnIgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb3ZtLmJyYW5jaEluZm9FcnJvciA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvdm0uYnJhbmNoSW5mb0Vycm9yTXNnID0gZXJyO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIC8vIHNob3cgYmFzaWMgaW5mb1xuICAgICAgICAgICAgICAgIHByb3ZtLmxvYWRCYXNpY0luZm8gPSAoY29sbGVjdGlvbk5hbWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgYWNjb3VudFxuICAgICAgICAgICAgICAgICAgICAgICAgLmxvYWRVc2VySW5mbyhjb2xsZWN0aW9uTmFtZSwgYXV0aGVudGljYXRpb24uY3VycmVudFVzZXIoKS5lbWFpbClcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKHJlc3BvbnNlID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzcG9uc2UuZGF0YS5lcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm92bS51c2VyQmFzaWNJbmZvTG9hZGluZ0Vycm9yID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvdm0udXNlckJhc2ljSW5mb0xvYWRpbmdFcnJvck1zZyA9IHJlc3BvbnNlLmRhdGEuZXJyb3I7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm92bS51c2VyQmFzaWNJbmZvTG9hZGluZ0Vycm9yID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb3ZtLmJhc2ljSW5mbyA9IHJlc3BvbnNlLmRhdGEudXNlckluZm87XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5jYXRjaChlcnIgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb3ZtLnVzZXJCYXNpY0luZm9Mb2FkaW5nRXJyb3IgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb3ZtLnVzZXJCYXNpY0luZm9Mb2FkaW5nRXJyb3JNc2cgPSBlcnI7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgLy8gc2hvdyBicmFuY2ggaW5mb1xuICAgICAgICAgICAgICAgIHByb3ZtLmxvYWRVc2VyQnJhbmNoID0gKGNvbGxlY3Rpb25OYW1lKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGFjY291bnRcbiAgICAgICAgICAgICAgICAgICAgICAgIC5sb2FkVXNlckluZm8oY29sbGVjdGlvbk5hbWUsIGF1dGhlbnRpY2F0aW9uLmN1cnJlbnRVc2VyKCkuZW1haWwpXG4gICAgICAgICAgICAgICAgICAgICAgICAudGhlbihyZXNwb25zZSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEuZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvdm0udXNlckluZm9Mb2FkaW5nRXJyb3IgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm92bS51c2VySW5mb0xvYWRpbmdFcnJvck1zZyA9IHJlc3BvbnNlLmRhdGEuZXJyb3I7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm92bS51c2VySW5mb0xvYWRpbmdFcnJvciA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm92bS5icmFuY2hJbmZvID0gcmVzcG9uc2UuZGF0YS51c2VySW5mbztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLmNhdGNoKGVyciA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvdm0udXNlckluZm9Mb2FkaW5nRXJyb3IgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb3ZtLnVzZXJJbmZvTG9hZGluZ0Vycm9yTXNnID0gZXJyO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGF1dGhlbnRpY2F0aW9uLmN1cnJlbnRVc2VyKCkuYWNjb3VudFR5cGUgPT09ICdhZG1pbicpIHtcblxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoJy9zaWduaW4nKTtcbiAgICAgICAgfVxuICAgIH1cblxufSkoKTtcbiIsIi8qXG58LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxufCBzZXR0aW5nIHVwIGNvbnRyb2xsZXIgZm9yIHNpdGUtY29udHJvbGwgcGFnZVxufCBAYXV0aG9yOiBqYWhpZCBoYXF1ZSA8amFoaWQuaGFxdWVAeWFob28uY29tPlxufCBAY29weXJpZ2h0OiBuYmEtc2xwLCAyMDE4XG58LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuKi9cblxuJ3VzZSBzdHJpY3QnO1xuXG4oZnVuY3Rpb24gKCkge1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCduYmFzbHAnKVxuICAgICAgICAuY29udHJvbGxlcignc2l0ZWNvbnRyb2xsQ3RybCcsIHNpdGVjb250cm9sbEN0cmwpO1xuXG4gICAgc2l0ZWNvbnRyb2xsQ3RybC4kaW5qZWN0ID0gWydhdXRoZW50aWNhdGlvbicsICckbG9jYXRpb24nLCAnc2l0ZWNvbnRyb2xsZXInXTtcblxuICAgIGZ1bmN0aW9uIHNpdGVjb250cm9sbEN0cmwoYXV0aGVudGljYXRpb24sICRsb2NhdGlvbiwgc2l0ZWNvbnRyb2xsZXIpIHtcbiAgICAgICAgY29uc3QgYWRTaXRlID0gdGhpcztcblxuICAgICAgICBpZiAoYXV0aGVudGljYXRpb24uaXNMb2dnZWRJbigpKSB7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmIChhdXRoZW50aWNhdGlvbi5jdXJyZW50VXNlcigpLmFjY291bnRUeXBlID09PSAnYWRtaW4nKSB7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgYWRTaXRlLmNvbW1pdHRlZSA9IHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogJycsXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAvLyBhZGQgY29tbWl0dGVlXG4gICAgICAgICAgICAgICAgYWRTaXRlLmFkZFByZWZlcnJlZENvbW1pdHRlZSA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgc2l0ZWNvbnRyb2xsZXJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5hZGRQcmVmZXJyZWRDb21taXR0ZWUoYWRTaXRlLmNvbW1pdHRlZSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKHJlc3BvbnNlID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzcG9uc2UuZGF0YS5lcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZFNpdGUuYWRkQ29tbWl0dGVlRXJyb3IgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZFNpdGUuYWRkQ29tbWl0dGVlRXJyb3JNc2cgPSByZXNwb25zZS5kYXRhLmVycm9yO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRTaXRlLmFkZENvbW1pdHRlZUVycm9yID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkU2l0ZS5hZGRDb21taXR0ZWVTdWNjZXNzTXNnID0gJ0NvbW1pdHRlZSBzdWNjZXNzZnVsbHkgYWRkZWQnO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNldCB0aW1lIG91dCBhbmQgY2FsbCBzaG93IGNvbW1pdHRlZSBtZXRob2QuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRTaXRlLnNob3dDb21taXR0ZWUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgMjAwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLmNhdGNoKGVyciA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRTaXRlLmFkZENvbW1pdHRlZUVycm9yID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZFNpdGUuYWRkQ29tbWl0dGVlRXJyb3JNc2cgPSBlcnI7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgLy8gc2hvdyBjb21taXR0ZWVcbiAgICAgICAgICAgICAgICBhZFNpdGUuc2hvd0NvbW1pdHRlZSA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgc2l0ZWNvbnRyb2xsZXJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zaG93QWxsQ29tbWl0dGVlKClcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKHJlc3BvbnNlID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzcG9uc2UuZGF0YS5lcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZFNpdGUuY29tbWl0dGVlRXJyb3IgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZFNpdGUuY29tbWl0dGVlRXJyb3JNc2cgPSByZXNwb25zZS5kYXRhLmVycm9yO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRTaXRlLmNvbW1pdHRlZUVycm9yID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkU2l0ZS5jb21taXR0ZWVMaXN0ID0gcmVzcG9uc2UuZGF0YS5jb21taXR0ZWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5jYXRjaChlcnIgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkU2l0ZS5jb21taXR0ZWVFcnJvciA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRTaXRlLmNvbW1pdHRlZUVycm9yTXNnID0gZXJyO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIC8vIHJlbW92ZSBpbmRpdmlkdWFsIGNvbW1pdHRlZS5cbiAgICAgICAgICAgICAgICBhZFNpdGUucmVtb3ZlTGlzdCA9IChjb21taXR0ZWVJZCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBzaXRlY29udHJvbGxlclxuICAgICAgICAgICAgICAgICAgICAgICAgLnJlbW92ZUNvbW1pdHRlZShjb21taXR0ZWVJZClcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKHJlc3BvbnNlID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzcG9uc2UuZGF0YS5lcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbGVydChyZXNwb25zZS5kYXRhLmVycm9yKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRTaXRlLnNob3dDb21taXR0ZWUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgMTAwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLmNhdGNoKGVyciA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxlcnQoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAkbG9jYXRpb24ucGF0aCgnL3dlbGNvbWUnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKCcvc2lnbmluJyk7XG4gICAgICAgIH1cbiAgICB9XG5cbn0pKCk7Il19
