"use strict";!function(){angular.module("nbaslp",["ngResource","ngRoute"]).config(["$routeProvider","$locationProvider",function(e,l){e.when("/",{templateUrl:"home/welcome/welcome.view.html",controller:"welcomeCtrl",controllerAs:"wvm"}).when("/signup",{templateUrl:"signup/signup.view.html",controller:"signupCtrl",controllerAs:"regvm"}).when("/signin",{templateUrl:"signin/signin.view.html",controller:"signinCtrl",controllerAs:"lvm"}).when("/profile",{templateUrl:"profile/profile.view.html",controller:"profileCtrl",controllerAs:"provm"}).when("/welcome",{templateUrl:"welcome/welcome.view.html",controller:"welcomeCtrl",controllerAs:"wvm"}),l.html5Mode({enabled:!0})}])}();
"use strict";function authentication(n,t){var e=function(t){n.localStorage.nbaslp=t},a=function(){return n.localStorage.nbaslp},o=function(){var t=a(),e=void 0;return!!t&&(e=t.split(".")[1],e=n.atob(e),e=JSON.parse(e))};return{currentUser:function(){if(o){var t=a().split(".")[1];return t=n.atob(t),t=JSON.parse(t),{userId:t._id,email:t.email,accountStatus:t.accountStatus,accountId:t.userId,name:t.name}}return!1},saveToken:e,getToken:a,isLoggedIn:o,signUp:function(n){return t.post("/api/signup",n).success(function(n){e(n.token)})},signIn:function(n){return t.post("/api/signin",n).success(function(n){e(n.token)})},Logout:function(){n.localStorage.removeItem("nbaslp")}}}angular.module("nbaslp").service("authentication",authentication),authentication.$inject=["$window","$http"];
"use strict";!function(){function t(t,n){var e=function(t){return t},u=function(t){return t};return{getAccountStatuses:function(t){return n.get("/api/"+t+"/statuses").then(e).catch(u)},updateUserStatus:function(t){return n.post("/api/userstatus/",t).then(e).catch(u)},saveBasicInfo:function(t){return n.post("/api/createbasicprofile",t).then(e).catch(u)}}}angular.module("nbaslp").service("account",t),t.$inject=["$window","$http"]}();
"use strict";!function(){angular.module("nbaslp").directive("siteNav",function(){return{restrict:"EA",templateUrl:"common/directives/nav/site-nav.template.html",controller:"navCtrl as nvm"}})}();
"use strict";!function(){function n(n,t){n.isLoggedIn()?(this.loggedInUri=!0,this.loggedInName=n.currentUser().name):this.loggedInUri=!1,this.logout=function(){n.Logout(),t.path("/signin")}}angular.module("nbaslp").controller("navCtrl",n),n.$inject=["authentication","$location"]}();
"use strict";!function(){angular.module("nbaslp").directive("siteFooter",function(){return{restrict:"EA",templateUrl:"common/directives/footer/footer.template.html"}})}();
"use strict";!function(){angular.module("nbaslp").controller("welcomeCtrl",function(){})}();
"use strict";!function(){function r(r,t){var o=this;o.user={firstName:"",lastName:"",displayName:"",email:"",password:"",confirmPassword:""},o.register=function(){r.signUp(o.user).then(function(r){r.data.error?(o.RegistrationError=!0,o.RegistrationErrorMsg=r.data.error):(o.RegistrationError=!1,t.path("/welcome"))}).catch(function(r){r&&(o.RegistrationError=!0,o.RegistrationErrorMsg=r.data.error)})},r.isLoggedIn()&&t.path("/welcome")}angular.module("nbaslp").controller("signupCtrl",r),r.$inject=["authentication","$location"]}();
"use strict";!function(){function r(r,o){var n=this;n.user={email:"",password:""},r.isLoggedIn()?o.path("/welcome"):(n.login=function(){n.user.email&&n.user.password?(n.loginError=!1,n.doLogin()):(n.loginError=!0,n.loginErrorMsg="Error! all * fields are required")},n.doLogin=function(){r.signIn(n.user).error(function(r){n.loginError=!0,n.loginErrorMsg=r.error}).then(function(){o.path("/welcome")})})}angular.module("nbaslp").controller("signinCtrl",r),r.$inject=["authentication","$location"]}();
"use strict";!function(){function t(t,r,a,o){var s=this;t.isLoggedIn()?(s.profileStatus=t.currentUser().accountStatus,s.getProfileStatuses=function(){a.getAccountStatuses(t.currentUser().email).then(function(t){t.data.error?(s.statusLoadError=!0,s.statusLoadErrorMsg=t.data.error):(s.statusLoadError=!1,s.userStatuses=t.data.statuses)}).catch(function(t){s.statusLoadError=!0,s.statusLoadErrorMsg=t})},s.basicProfile={whos:t.currentUser().email,userId:t.currentUser().userId,formerName:"",sex:"",tele:"",address:""},s.saveBasicInfo=function(){a.saveBasicInfo(s.basicProfile).then(function(r){r.data.error?(s.basicAccountInfoError=!0,s.basicAccountInfoErrorMsg=r.data.error):(s.basicAccountInfoError=!1,s.updatedStatus={update_at:"basic_info",email:t.currentUser().email,status:!0},a.updateUserStatus(s.updatedStatus).then(function(t){t.data.error?(s.basicAccountInfoError=!0,s.basicAccountInfoErrorMsg=t.data.error):(s.statusUpdateError=!1,o.reload())}))}).catch(function(t){})}):r.path("/signin")}angular.module("nbaslp").controller("profileCtrl",t),t.$inject=["authentication","$location","account","$route"]}();
"use strict";!function(){function n(n,t){}angular.module("nbaslp").controller("welcomeCtrl",n),n.$inject=["authentication","$location"]}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsImF1dGhlbnRpY2F0aW9uLnNlcnZpY2UuanMiLCJhY2NvdW50LnNlcnZpY2UuanMiLCJuYXYuZGlyZWN0aXZlLmpzIiwibmF2LmNvbnRyb2xsZXIuanMiLCJmb290ZXIuZGlyZWN0aXZlLmpzIiwid2VsY29tZS5jb250cm9sbGVyLmpzIiwic2lnbnVwLmNvbnRyb2xsZXIuanMiLCJzaWduaW4uY29udHJvbGxlci5qcyIsInByb2ZpbGUuY29udHJvbGxlci5qcyJdLCJuYW1lcyI6WyJhbmd1bGFyIiwibW9kdWxlIiwiY29uZmlnIiwidGVtcGxhdGVVcmwiLCIkbG9jYXRpb25Qcm92aWRlciIsImNvbnRyb2xsZXIiLCJjb250cm9sbGVyQXMiLCJ3aGVuIiwiZW5hYmxlZCIsImh0bWw1TW9kZSIsInNhdmVUb2tlbiIsIiR3aW5kb3ciLCJ0b2tlbiIsImxvY2FsU3RvcmFnZSIsImdldFRva2VuIiwiaXNMb2dnZWRJbiIsInBheWxvYWQiLCJKU09OIiwicGFyc2UiLCJhdG9iIiwiY3VycmVudFVzZXIiLCJzcGxpdCIsImFjY291bnRTdGF0dXMiLCJ1c2VySWQiLCJfaWQiLCJhY2NvdW50SWQiLCJuYW1lIiwiTG9nb3V0Iiwic2lnblVwIiwidXNlciIsIiRodHRwIiwicG9zdCIsInN1Y2Nlc3MiLCJkYXRhIiwic2lnbkluIiwiaGFuZGxlU3VjY2VzcyIsInJlbW92ZUl0ZW0iLCJhdXRoZW50aWNhdGlvbiIsImdldEFjY291bnRTdGF0dXNlcyIsInNhdmVCYXNpY0luZm8iLCJoYW5kbGVFcnJvciIsInJlc3BvbnNlIiwidXBkYXRlVXNlclN0YXR1cyIsInRoZW4iLCJjYXRjaCIsInVwZGF0ZURhdGEiLCJhY2NvdW50IiwiJGluamVjdCIsImRpcmVjdGl2ZSIsInNpdGVOYXYiLCJyZXN0cmljdCIsIm5hdkN0cmwiLCIkbG9jYXRpb24iLCJudm0iLCJsb2dnZWRJbk5hbWUiLCJsb2dnZWRJblVyaSIsImxvZ291dCIsInBhdGgiLCJzaXRlRm9vdGVyIiwic2lnbnVwQ3RybCIsInJlZ3ZtIiwidGhpcyIsImxhc3ROYW1lIiwiZGlzcGxheU5hbWUiLCJlbWFpbCIsInBhc3N3b3JkIiwiY29uZmlybVBhc3N3b3JkIiwicmVnaXN0ZXIiLCJSZWdpc3RyYXRpb25FcnJvck1zZyIsIlJlZ2lzdHJhdGlvbkVycm9yIiwiZXJyb3IiLCJlcnIiLCJzaWduaW5DdHJsIiwibHZtIiwibG9naW5FcnJvck1zZyIsImxvZ2luRXJyb3IiLCJkb0xvZ2luIiwicHJvdm0iLCIkcm91dGUiLCJwcm9maWxlU3RhdHVzIiwiZ2V0UHJvZmlsZVN0YXR1c2VzIiwic3RhdHVzTG9hZEVycm9yTXNnIiwic3RhdHVzTG9hZEVycm9yIiwidXNlclN0YXR1c2VzIiwic3RhdHVzZXMiLCJiYXNpY1Byb2ZpbGUiLCJhZGRyZXNzIiwid2hvcyIsInRlbGUiLCJiYXNpY0FjY291bnRJbmZvRXJyb3IiLCJ1cGRhdGVkU3RhdHVzIiwidXBkYXRlX2F0Iiwic3RhdHVzIiwiYmFzaWNBY2NvdW50SW5mb0Vycm9yTXNnIiwic3RhdHVzVXBkYXRlRXJyb3IiLCJyZWxvYWQiLCJwcm9maWxlQ3RybCIsIndlbGNvbWVDdHJsIl0sIm1hcHBpbmdzIjoiQUFRQSxjQUVBLFdBQ0lBLFFBQ0tDLE9BQU8sVUFBVyxhQUFjLFlBR3JDQyxRQUFTQSxpQkFBVCxvQkFHWUMsU0FBQUEsRUFBYUMsR0FDYkMsRUFDQUMsS0FBQUEsS0FFRUgsWUFBVyxpQ0FDYkEsV0FBYSxjQUNiRSxhQUFZLFFBR2ZFLEtBQUssV0FDRkosWUFBYSwwQkFDYkUsV0FBWSxhQUNaQyxhQUFjLFVBR2RILEtBQUFBLFdBQ0FFLFlBQVksMEJBQ1pDLFdBQWMsYUFFWkEsYUFBWSxRQUVkRCxLQUFBQSxZQUNBQyxZQUFjLDRCQXhCdEJELFdBQUEsY0FtQlFDLGFBQWMsVUFTbEJFLEtBQUFBLFlBREpMLFlBQUEsNEJBR0hFLFdBQUEsY0FwQ0xDLGFBQUEsUUFpQ1FGLEVBQWtCSyxXQUNkRCxTQUFTLE9BbENyQjtBQ0ZBLGFBVUksU0FBTUUsZUFBWUMsRUFBWkQsR0FFTCxJQUZEQSxFQUFBLFNBQUFFLEdBQ0lELEVBQVFFLGFBQVIsT0FBaUNELEdBR3JDRSxFQUFBLFdBQ0ksT0FBT0gsRUFBUUUsYUFBUixRQUtQRSxFQUFJQyxXQURKLElBQU1KLEVBQVFFLElBR1ZGLE9BQUFBLEVBRUFJLFFBQUFBLElBQ0FBLEVBQVVDLEVBQUtDLE1BQU1GLEtBQUFBLEdBQ3JCQSxFQUFPQSxFQUFQRyxLQUFBSCxHQUpKQSxFQU1LQyxLQUFBQyxNQUFBRixLQTZDVCxPQUNJSSxZQXRDUUosV0FDSkEsR0FBQUEsRUFBVUwsQ0FDVkssSUFGSUEsRUFFTUMsSUFGVUksTUFBTSxLQUFLLEdBTzNCQyxPQUhKTixFQUFPTCxFQUFBUSxLQUFBSCxHQUNITyxFQUFBQSxLQUFRUCxNQUFRUSxJQUdoQkMsT0FBQUEsRUFBV1QsSUFDWFUsTUFBTVYsRUFBUVUsTUFMbEJKLGNBQUFOLEVBQUFNLGNBUUNHLFVBQUFULEVBQUFPLE9BQ0RHLEtBQU9WLEVBQVBVLE1BSUZDLE9BQVMsR0FzQlhqQixVQUFXQSxFQUNYSSxTQUFVQSxFQUNWQyxXQUFZQSxFQUNaYSxPQXJCSixTQUFBQyxHQUNJLE9BQU9DLEVBQU1DLEtBQUssY0FBZUYsR0FBTUcsUUFBUSxTQUFVQyxHQUt2REMsRUFBU0QsRUFBVEMsVUFnQkZBLE9BaEJKLFNBQUFMLEdBQ0ksT0FBT0MsRUFBTUMsS0FBSyxjQUFlRixHQUFNRyxRQUFRLFNBQVVDLEdBS3ZERSxFQUFBQSxFQUFnQnZCLFVBV2xCZSxPQXZCVyxXQUNYaEIsRUFBT21CLGFBQVdNLFdBQVgsWUF4RGZwQyxRQUNLQyxPQUFPLFVBR1pvQyxRQUFBQSxpQkFBMEJBLGdCQUUxQkEsZUFBU0EsU0FBZTFCLFVBQVNtQjtBQ1JqQyxjQUVBLFdBU1EsU0FBTVEsRUFBQUEsRUFBQUEsR0FLTCxJQXVCR0MsRUFBZUEsU0FBQUEsR0FBQUEsT0FBQUEsR0FFdEJDLEVBQUEsU0FBQUMsR0FBQSxPQUFBQSxHQUxHLE9BQ0lILG1CQTFCSixTQUFBZixHQUNJLE9BQU9PLEVBTUxZLElBQUFBLFFBQW1CbkIsRUFBbkJtQixhQUNGQyxLQUFPYixHQURYYyxNQUFBSixJQW9CSUUsaUJBWFUsU0FBQUcsR0FGZCxPQUFBZixFQUxTQyxLQUFLLG1CQUFvQmMsR0FZNUJWLEtBQUFBLEdBQWdCUyxNQUFjSCxJQU9oQ0YsY0FMZ0IsU0FBQU4sR0FBQSxPQUFjUSxFQUFsQ1YsS0FBQSwwQkFBQUUsR0FOU1UsS0FBS1IsR0FRUFMsTUFBQUosS0FqQ1h4QyxRQUNLQyxPQUFPLFVBR1o2QyxRQUFRQyxVQUFXRCxHQUVuQkEsRUFBQUMsU0FBaUJwQyxVQUFTbUIsU0FQOUI7QUNGQSxjQUVBLFdBQ0k5QixRQUNLQyxPQUFPLFVBR1orQyxVQUFTQyxVQUVEQyxXQUNBL0MsT0FDQUUsU0FBQUEsS0FISkYsWUFBQSwrQ0FLSEUsV0FBQSxvQkFYTDtBQ0ZBLGNBRUEsV0FPSSxTQUFTOEMsRUFBUWQsRUFBZ0JlLEdBS3pCQyxFQUFJQyxjQUZKakIsS0FJQ2tCLGFBQUEsRUFKRGxCLEtBS0lrQixhQUFjbEIsRUFBbEJqQixjQUFBTSxNQUxBVyxLQVFBbUIsYUFBUyxFQVJUbkIsS0FRSm1CLE9BQUEsV0FJSG5CLEVBQUFWLFNBdEJMeUIsRUFBQUssS0FBQSxZQUNJekQsUUFDS0MsT0FBTyxVQUdaa0QsV0FBQSxVQUFtQkEsR0FFbkJBLEVBQUFKLFNBQWlCVixpQkFBZ0JlLGFBUHJDO0FDRkEsY0FFQSxXQUNJcEQsUUFHQUMsT0FBU3lELFVBQ0xWLFVBQU8sYUFDSEUsV0FDQS9DLE9BRkorQyxTQUFBLEtBSUgvQyxZQUFBLG1EQVRMO0FDSEEsY0FDQSxXQUFDSCxRQUNBQSxPQUNFQyxVQUNBSSxXQUFXLGNBR1osY0FORjtBQ0FBLGNBRUEsV0FPSSxTQUFTc0QsRUFBV3RCLEVBQWdCZSxHQUdoQyxJQUFBUSxFQUFBQyxLQUdJQyxFQUFBQSxNQUNBQyxVQUFBQSxHQUNBQyxTQUpTLEdBS1RDLFlBTFMsR0FNVEMsTUFBQUEsR0FOSkQsU0FBQSxHQU1JQyxnQkFBaUIsSUFPVE4sRUFBQU8sU0FBSTFCLFdBQ0FtQixFQUNBQSxPQUFBQSxFQUFNUSxNQUZWekIsS0FBQSxTQUlLRixHQUNEbUIsRUFBTVMsS0FBQUEsT0FDTmpCLEVBQVVLLG1CQUFWLEVBQ0hHLEVBQUFRLHFCQUFBM0IsRUFBQVIsS0FBQXFDLFFBSUdWLEVBQU1TLG1CQUFOLEVBQ0FULEVBQU1RLEtBQUFBLGVBaEJ0QnhCLE1BQUEsU0FBQTJCLEdBY2dCQSxJQU9abEMsRUFBZXRCLG1CQUFjLEVBQ25CMEMsRUFBS1cscUJBQWZHLEVBQUF0QyxLQUFBcUMsVUFEQWpDLEVBQWV0QixjQUNmcUMsRUFBVUssS0FBSyxZQXpDdkJ6RCxRQUNLQyxPQUFPLFVBR1owRCxXQUFXWixhQUFXWSxHQUV0QkEsRUFBU0EsU0FBV3RCLGlCQUFnQmUsYUFQeEM7QUNGQSxjQUVBLFdBT0ksU0FBU29CLEVBQVduQyxFQUFnQmUsR0FHaENxQixJQUFJNUMsRUFBT2dDLEtBRVBJLEVBQUFBLE1BRkpELE1BQUEsR0FFSUMsU0FBVSxJQUdkNUIsRUFHS3RCLGFBQ0QwRCxFQUFBaEIsS0FBWSxhQUdKZ0IsRUFBQUEsTUFBSUMsV0FGUkQsRUFJSzVDLEtBQUFtQyxPQUFBUyxFQUFBNUMsS0FBQW9DLFVBQ0RRLEVBQUlFLFlBQWEsRUFLckJDLEVBQUpBLFlBTFFILEVBQUlFLFlBQWEsRUFDakJGLEVBQUlHLGNBQUpILHFDQVVDQSxFQUFBRyxRQUNLLFdBQ0Z4QixFQVBSbEIsT0FBQXVDLEVBQUE1QyxNQURKeUMsTUFBQSxTQUFBQyxHQVdIRSxFQUFBRSxZQUFBLEVBQ0pGLEVBQUFDLGNBQUFILEVBQUFELFFBTGdCM0IsS0FBSyxXQUNGUyxFQUFVSyxLQUFLLGdCQXJDbkN6RCxRQUNLQyxPQUFPLFVBR1p1RSxXQUFXekIsYUFBV3lCLEdBRXRCQSxFQUFTQSxTQUFXbkMsaUJBQWdCZSxhQVB4QztBQ0ZBLGNBRUEsV0FVUSxTQUFNeUIsRUFBTnhDLEVBQUFlLEVBQUFOLEVBQUFnQyxHQUVBLElBQUl6QyxFQUFBQSxLQUFBQSxFQUFldEIsY0FHZjhELEVBQUFFLGNBQUExQyxFQUFBakIsY0FBQUUsY0FLWXVELEVBQUFHLG1CQUFrQlYsV0FDZE8sRUFDQUEsbUJBQU1JLEVBQXFCeEMsY0FBYzZCLE9BRjdDM0IsS0FBQSxTQUFBRixHQUtJb0MsRUFBTUssS0FBQUEsT0FDTkwsRUFBTU0saUJBQWUxQyxFQUN4Qm9DLEVBQUFJLG1CQUFBeEMsRUFBQVIsS0FBQXFDLFFBSUtXLEVBQUFBLGlCQUFOLEVBZFJKLEVBQUFNLGFBQUExQyxFQUFBUixLQUFBbUQsWUFrQkp4QyxNQUFBLFNBQUEyQixHQUNNYyxFQUFOSCxpQkFBcUIsRUFDWDdDLEVBQUFBLG1CQUE2QjJCLEtBS25Dc0IsRUFBQUEsY0FOSkMsS0FBQWxELEVBQUFqQixjQUFBNEMsTUFFSXpDLE9BQVFjLEVBQWVqQixjQUFjRyxPQU96Q3NELFdBQU10QyxHQUNGTyxJQUFBQSxHQUdRMEMsS0FBQSxHQUNJWCxRQUFBQSxJQUlBQSxFQUFBQSxjQUFNWSxXQVJsQjNDLEVBVVkrQixjQUFNYSxFQUFBQSxjQUNGQyxLQUFBQSxTQUFBQSxHQUNBM0IsRUFBTzNCLEtBQUFBLE9BQ1B1RCxFQUFBQSx1QkFBUSxFQUhaZixFQUFBZ0IseUJBQUFwRCxFQUFBUixLQUFBcUMsUUFPQXhCLEVBQ0tKLHVCQUF1QmdELEVBR2hCYixFQUFBQSxlQUNBQSxVQUFNZ0IsYUFGVjdCLE1BSUszQixFQUFBakIsY0FBQTRDLE1BQ0RhLFFBQU1pQixHQUlyQmhELEVBRUVKLGlCQS9CWG1DLEVBQUFhLGVBREovQyxLQUFBLFNBQUFGLEdBcUNDQSxFQUFBUixLQUFBcUMsT0FDRE8sRUFBQVksdUJBQUEsRUFDSFosRUFBQWdCLHlCQUFBcEQsRUFBQVIsS0FBQXFDLFFBYitCTyxFQUFNaUIsbUJBQW9CLEVBQzFCaEIsRUFBT2lCLGVBSzFCbkQsTUFBTSxTQUFDMkIsUUFNaEJuQixFQUFVSyxLQUFLLFdBakZ2QnpELFFBQ0tDLE9BQU8sVUFHWitGLFdBQVlqRCxjQUFXaUQsR0FFdkJBLEVBQVNBLFNBQVkzRCxpQkFBZ0JlLFlBQVdOLFVBQWlCLFVBUnJFO0FIRkEsY0FFQSxXQVVLLFNBQUFtRCxFQUFBNUQsRUFBQWUsSUFSRHBELFFBQ0tDLE9BQU8sVUFHWmdHLFdBQVlsRCxjQUFXa0QsR0FFdkJBLEVBQVNBLFNBQVk1RCxpQkFBZ0JlLGFBUnpDIiwiZmlsZSI6ImFwcC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKlxufC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbnwgc2V0dGluZyB1cCBlbnRyeSBwb2ludCBmb3IgYW5ndWxhciBmcm9udC1lbmRcbnwgQGF1dGhvcjogamFoaWQgaGFxdWUgPGphaGlkLmhhcXVlQHlhaG9vLmNvbT5cbnwgQGNvcHlyaWdodDogbmJhLXNscCwgMjAxN1xufC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiovXG5cbid1c2Ugc3RyaWN0JztcblxuKGZ1bmN0aW9uICgpIHtcbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ25iYXNscCcsIFsnbmdSZXNvdXJjZScsICduZ1JvdXRlJ10pXG4gICAgICAgIC5jb25maWcoWyckcm91dGVQcm92aWRlcicsICckbG9jYXRpb25Qcm92aWRlcicsIGNvbmZpZ10pO1xuXG4gICAgZnVuY3Rpb24gY29uZmlnKCRyb3V0ZVByb3ZpZGVyLCAkbG9jYXRpb25Qcm92aWRlcikge1xuICAgICAgICAkcm91dGVQcm92aWRlclxuICAgICAgICAgICAgLndoZW4oJy8nLCB7XG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdob21lL3dlbGNvbWUvd2VsY29tZS52aWV3Lmh0bWwnLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICd3ZWxjb21lQ3RybCcsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlckFzOiAnd3ZtJyxcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAud2hlbignL3NpZ251cCcsIHtcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3NpZ251cC9zaWdudXAudmlldy5odG1sJyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnc2lnbnVwQ3RybCcsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlckFzOiAncmVndm0nLFxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC53aGVuKCcvc2lnbmluJywge1xuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnc2lnbmluL3NpZ25pbi52aWV3Lmh0bWwnLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdzaWduaW5DdHJsJyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyQXM6ICdsdm0nLFxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC53aGVuKCcvcHJvZmlsZScsIHtcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3Byb2ZpbGUvcHJvZmlsZS52aWV3Lmh0bWwnLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdwcm9maWxlQ3RybCcsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlckFzOiAncHJvdm0nLFxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC53aGVuKCcvd2VsY29tZScsIHtcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3dlbGNvbWUvd2VsY29tZS52aWV3Lmh0bWwnLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICd3ZWxjb21lQ3RybCcsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlckFzOiAnd3ZtJyxcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICRsb2NhdGlvblByb3ZpZGVyLmh0bWw1TW9kZSh7XG4gICAgICAgICAgICBlbmFibGVkOiB0cnVlLFxuICAgICAgICB9KTtcbiAgICB9XG59KSgpO1xuIiwiLypcbnwtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG58IHNldHRpbmcgdXAgYXV0aGVudGljYXRpb24gc2VydmljZSBcbnwgQGF1dGhvcjogamFoaWQgaGFxdWUgPGphaGlkLmhhcXVlQHlhaG9vLmNvbT5cbnwgQGNvcHlyaWdodDogbmJhLXNscCwgMjAxN1xufC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiovXG5cbid1c2Ugc3RyaWN0JztcblxuYW5ndWxhclxuICAgIC5tb2R1bGUoJ25iYXNscCcpXG4gICAgLnNlcnZpY2UoJ2F1dGhlbnRpY2F0aW9uJywgYXV0aGVudGljYXRpb24pO1xuXG5hdXRoZW50aWNhdGlvbi4kaW5qZWN0ID0gWyckd2luZG93JywgJyRodHRwJ107XG5cbmZ1bmN0aW9uIGF1dGhlbnRpY2F0aW9uKCR3aW5kb3csICRodHRwKSB7XG4vLyBzYXZpbmcgdG9rZW4uXG4gICAgY29uc3Qgc2F2ZVRva2VuID1cdGZ1bmN0aW9uICh0b2tlbikge1xuICAgICAgICAkd2luZG93LmxvY2FsU3RvcmFnZVsnbmJhc2xwJ10gPSB0b2tlbjtcbiAgICB9O1xuXG4gICAgY29uc3QgZ2V0VG9rZW4gPVx0ZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gJHdpbmRvdy5sb2NhbFN0b3JhZ2VbJ25iYXNscCddO1xuICAgIH07XG5cbiAgICBjb25zdCBpc0xvZ2dlZEluID0gKCkgPT4ge1xuICAgICAgICBjb25zdCB0b2tlbiA9IGdldFRva2VuKCk7XG4gICAgICAgIGxldCBwYXlsb2FkO1xuXG4gICAgICAgIGlmICh0b2tlbikge1xuICAgICAgICAgICAgcGF5bG9hZCA9IHRva2VuLnNwbGl0KCcuJylbMV07XG4gICAgICAgICAgICBwYXlsb2FkID0gJHdpbmRvdy5hdG9iKHBheWxvYWQpO1xuICAgICAgICAgICAgcGF5bG9hZCA9IEpTT04ucGFyc2UocGF5bG9hZCk7XG4gICAgICAgICAgICByZXR1cm4gcGF5bG9hZDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBjb25zdCBjdXJyZW50VXNlciA9ICgpID0+IHtcbiAgICAgICAgaWYgKGlzTG9nZ2VkSW4pIHtcbiAgICAgICAgICAgIGNvbnN0IHRva2VuID0gZ2V0VG9rZW4oKTtcbiAgICAgICAgICAgIGxldCBwYXlsb2FkID0gdG9rZW4uc3BsaXQoJy4nKVsxXTtcbiAgICAgICAgICAgIHBheWxvYWQgPSAkd2luZG93LmF0b2IocGF5bG9hZCk7XG4gICAgICAgICAgICBwYXlsb2FkID0gSlNPTi5wYXJzZShwYXlsb2FkKTtcblxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB1c2VySWQ6IHBheWxvYWQuX2lkLFxuICAgICAgICAgICAgICAgIGVtYWlsOiBwYXlsb2FkLmVtYWlsLFxuICAgICAgICAgICAgICAgIGFjY291bnRTdGF0dXM6IHBheWxvYWQuYWNjb3VudFN0YXR1cyxcbiAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IHBheWxvYWQudXNlcklkLFxuICAgICAgICAgICAgICAgIG5hbWU6IHBheWxvYWQubmFtZSxcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgY29uc3QgTG9nb3V0ID0gKCkgPT4ge1xuICAgICAgICAkd2luZG93LmxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCduYmFzbHAnKTtcbiAgICB9O1xuXG4gICAgY29uc3Qgc2lnblVwID0gKHVzZXIpID0+IHtcbiAgICAgICAgcmV0dXJuICRodHRwLnBvc3QoJy9hcGkvc2lnbnVwJywgdXNlcikuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgc2F2ZVRva2VuKGRhdGEudG9rZW4pO1xuICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgY29uc3Qgc2lnbkluID0gKHVzZXIpID0+IHtcbiAgICAgICAgcmV0dXJuICRodHRwLnBvc3QoJy9hcGkvc2lnbmluJywgdXNlcikuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgc2F2ZVRva2VuKGRhdGEudG9rZW4pO1xuICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgY29uc3QgaGFuZGxlU3VjY2VzcyA9IChyZXNwb25zZSkgPT4gcmVzcG9uc2U7XG5cbiAgICBjb25zdCBoYW5kbGVFcnJvciA9IChyZXNwb25zZSkgPT4gcmVzcG9uc2U7XG5cbiAgICByZXR1cm4ge1xuICAgICAgICBjdXJyZW50VXNlcjogY3VycmVudFVzZXIsXG4gICAgICAgIHNhdmVUb2tlbjogc2F2ZVRva2VuLFxuICAgICAgICBnZXRUb2tlbjogZ2V0VG9rZW4sXG4gICAgICAgIGlzTG9nZ2VkSW46IGlzTG9nZ2VkSW4sXG4gICAgICAgIHNpZ25VcDogc2lnblVwLFxuICAgICAgICBzaWduSW46IHNpZ25JbixcbiAgICAgICAgTG9nb3V0OiBMb2dvdXQsXG4gICAgfTtcbn1cblxuIiwiLypcbnwtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG58IHNldHRpbmcgdXAgYWNjb3VudCBzZXJ2aWNlIGZvciBhcHBcbnwgQGF1dGhvcjogamFoaWQgaGFxdWUgPGphaGlkLmhhcXVlQHlhaG9vLmNvbT5cbnwgQGNvcHlyaWdodDogbmJhLXNscCwgMjAxN1xufC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiovXG5cbid1c2Ugc3RyaWN0JztcblxuKGZ1bmN0aW9uICgpIHtcbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ25iYXNscCcpXG4gICAgICAgIC5zZXJ2aWNlKCdhY2NvdW50JywgYWNjb3VudCk7XG5cbiAgICBhY2NvdW50LiRpbmplY3QgPSBbJyR3aW5kb3cnLCAnJGh0dHAnXTtcblxuICAgIGZ1bmN0aW9uIGFjY291bnQoJHdpbmRvdywgJGh0dHApIHtcblxuICAgICAgICBjb25zdCBnZXRBY2NvdW50U3RhdHVzZXMgPSAodXNlcklkKSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gJGh0dHAgXG4gICAgICAgICAgICAgICAgLmdldCgnL2FwaS8nICsgdXNlcklkICsgJy9zdGF0dXNlcycpXG4gICAgICAgICAgICAgICAgLnRoZW4oaGFuZGxlU3VjY2VzcylcbiAgICAgICAgICAgICAgICAuY2F0Y2goaGFuZGxlRXJyb3IpO1xuICAgICAgICB9O1xuXG4gICAgICAgIGNvbnN0IHVwZGF0ZVVzZXJTdGF0dXMgPSBmdW5jdGlvbiAodXBkYXRlRGF0YSkge1xuICAgICAgICAgICAgcmV0dXJuICRodHRwXG4gICAgICAgICAgICAgICAgLnBvc3QoJy9hcGkvdXNlcnN0YXR1cy8nLCB1cGRhdGVEYXRhKVxuICAgICAgICAgICAgICAgIC50aGVuKGhhbmRsZVN1Y2Nlc3MpXG4gICAgICAgICAgICAgICAgLmNhdGNoKGhhbmRsZUVycm9yKTtcbiAgICAgICAgfTtcblxuICAgICAgICBjb25zdCBzYXZlQmFzaWNJbmZvID0gKGRhdGEpID0+IHtcbiAgICAgICAgICAgIHJldHVybiAkaHR0cCBcbiAgICAgICAgICAgICAgICAucG9zdCgnL2FwaS9jcmVhdGViYXNpY3Byb2ZpbGUnLCBkYXRhKVxuICAgICAgICAgICAgICAgIC50aGVuKGhhbmRsZVN1Y2Nlc3MpXG4gICAgICAgICAgICAgICAgLmNhdGNoKGhhbmRsZUVycm9yKTtcbiAgICAgICAgfTtcblxuICAgICAgICBjb25zdCBoYW5kbGVTdWNjZXNzID0gKHJlc3BvbnNlKSA9PiByZXNwb25zZTtcblxuICAgICAgICBjb25zdCBoYW5kbGVFcnJvciA9IChyZXNwb25zZSkgPT4gcmVzcG9uc2U7XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGdldEFjY291bnRTdGF0dXNlczogZ2V0QWNjb3VudFN0YXR1c2VzLFxuICAgICAgICAgICAgdXBkYXRlVXNlclN0YXR1czogdXBkYXRlVXNlclN0YXR1cyxcbiAgICAgICAgICAgIHNhdmVCYXNpY0luZm86IHNhdmVCYXNpY0luZm8sXG4gICAgICAgIH07XG4gICAgfVxuXG59KSgpO1xuIiwiLypcbnwtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG58IHNldHRpbmcgdXAgbmF2aWdhdGlvbiBkaXJlY3RpdmUgZm9yIHRoZSBhcHBcbnwgQGF1dGhvcjogamFoaWQgaGFxdWUgPGphaGlkLmhhcXVlQHlhaG9vLmNvbT5cbnwgQGNvcHlyaWdodDogbmJhc2xwLCAyMDE3XG58LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuKi9cblxuJ3VzZSBzdHJpY3QnO1xuXG4oZnVuY3Rpb24gKCkge1xuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnbmJhc2xwJylcbiAgICAgICAgLmRpcmVjdGl2ZSgnc2l0ZU5hdicsIHNpdGVOYXYpO1xuXG4gICAgZnVuY3Rpb24gc2l0ZU5hdigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnRUEnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdjb21tb24vZGlyZWN0aXZlcy9uYXYvc2l0ZS1uYXYudGVtcGxhdGUuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnbmF2Q3RybCBhcyBudm0nLFxuICAgICAgICB9O1xuICAgIH1cbn0pKCk7XG4iLCIvKlxufC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbnwgc2V0dGluZyB1cCBjb250cm9sbGVyIGZvciBuYXZpZ2F0aW9uXG58IEBhdXRob3I6IGphaGlkIGhhcXVlIDxqYWhpZC5oYXF1ZUB5YWhvby5jb20+XG58IEBjb3B5cmlnaHQ6IG5iYXNscCwgMjAxN1xufC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiovXG5cbid1c2Ugc3RyaWN0JztcblxuKGZ1bmN0aW9uICgpIHtcbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ25iYXNscCcpXG4gICAgICAgIC5jb250cm9sbGVyKCduYXZDdHJsJywgbmF2Q3RybCk7XG5cbiAgICBuYXZDdHJsLiRpbmplY3QgPSBbJ2F1dGhlbnRpY2F0aW9uJywgJyRsb2NhdGlvbiddO1xuXG4gICAgZnVuY3Rpb24gbmF2Q3RybChhdXRoZW50aWNhdGlvbiwgJGxvY2F0aW9uKSB7XG4gICAgICAgIGNvbnN0IG52bSA9IHRoaXM7XG5cbiAgICAgICAgaWYgKGF1dGhlbnRpY2F0aW9uLmlzTG9nZ2VkSW4oKSkge1xuICAgICAgICAgICAgbnZtLmxvZ2dlZEluVXJpID0gdHJ1ZTtcbiAgICAgICAgICAgIG52bS5sb2dnZWRJbk5hbWUgPSBhdXRoZW50aWNhdGlvbi5jdXJyZW50VXNlcigpLm5hbWU7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBudm0ubG9nZ2VkSW5VcmkgPSBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIG52bS5sb2dvdXQgPSAoKSA9PiB7XG4gICAgICAgICAgICBhdXRoZW50aWNhdGlvbi5Mb2dvdXQoKTtcbiAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKCcvc2lnbmluJyk7XG4gICAgICAgIH07XG4gICAgfVxufSkoKTtcbiIsIi8qXG58LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxufCBzZXR0aW5nIHVwIGZvb3RlciBkaXJlY3RpdmUgZm9yIGFwcGxpY2F0aW9uXG58IEBhdXRob3I6IGphaGlkIGhhcXVlIDxqYWhpZC5oYXF1ZUB5YWhvby5jb20+XG58IEBjb3B5cmlnaHQ6IG5iYXNscCwgMjAxN1xufC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiovXG5cbid1c2Ugc3RyaWN0JztcblxuKGZ1bmN0aW9uICgpIHtcbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ25iYXNscCcpXG4gICAgICAgIC5kaXJlY3RpdmUoJ3NpdGVGb290ZXInLCBzaXRlRm9vdGVyKTtcbiAgICBmdW5jdGlvbiBzaXRlRm9vdGVyKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgcmVzdHJpY3Q6ICdFQScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2NvbW1vbi9kaXJlY3RpdmVzL2Zvb3Rlci9mb290ZXIudGVtcGxhdGUuaHRtbCcsXG4gICAgICAgIH07XG4gICAgfVxufSkoKTtcbiIsIi8qXG58LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxufCBzZXR0aW5nIHVwIGNvbnRyb2xsZXIgZm9yIHdlbGNvbWUgcGFnZVxufCBAYXV0aG9yOiBqYWhpZCBoYXF1ZSA8amFoaWQuaGFxdWVAeWFob28uY29tPlxufCBAY29weXJpZ2h0OiBuYmFzbHAsIDIwMTdcbnwtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4qL1xuXG4ndXNlIHN0cmljdCc7XG5cbihmdW5jdGlvbiAoKSB7XG4gICAgXG4gICAgYW5ndWxhciBcbiAgICAgICAgLm1vZHVsZSgnbmJhc2xwJylcbiAgICAgICAgLmNvbnRyb2xsZXIoJ3dlbGNvbWVDdHJsJywgd2VsY29tZUN0cmwpO1xuXG4gICAgd2VsY29tZUN0cmwuJGluamVjdCA9IFsnYXV0aGVudGljYXRpb24nLCAnJGxvY2F0aW9uJ107XG5cbiAgICBmdW5jdGlvbiB3ZWxjb21lQ3RybChhdXRoZW50aWNhdGlvbiwgJGxvY2F0aW9uKSB7XG4gICAgICAgIGNvbnN0IHd2bSA9IHRoaXM7XG4gICAgfVxuXG59KSgpO1xuIiwiLypcbnwtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG58IHNldHRpbmcgdXAgc2lnbnVwIGNvbnRyb2xsZXIgZm9yIHRoZSBhcHBcbnwgQGF1dGhvcjogamFoaWQgaGFxdWUgPGphaGlkLmhhcXVlQHlhaG9vLmNvbT5cbnwgQGNvcHlyaWdodDogbmJhc2xwLCAyMDE3XG58LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuKi9cblxuJ3VzZSBzdHJpY3QnO1xuXG4oZnVuY3Rpb24gKCkge1xuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnbmJhc2xwJylcbiAgICAgICAgLmNvbnRyb2xsZXIoJ3NpZ251cEN0cmwnLCBzaWdudXBDdHJsKTtcblxuICAgIHNpZ251cEN0cmwuJGluamVjdCA9IFsnYXV0aGVudGljYXRpb24nLCAnJGxvY2F0aW9uJ107XG5cbiAgICBmdW5jdGlvbiBzaWdudXBDdHJsKGF1dGhlbnRpY2F0aW9uLCAkbG9jYXRpb24pIHtcbiAgICAgICAgY29uc3QgcmVndm0gPSB0aGlzO1xuXG4gICAgICAgIC8vIHVzZXIgb2JqZWN0LlxuICAgICAgICByZWd2bS51c2VyID0ge1xuICAgICAgICAgICAgZmlyc3ROYW1lOiAnJyxcbiAgICAgICAgICAgIGxhc3ROYW1lOiAnJyxcbiAgICAgICAgICAgIGRpc3BsYXlOYW1lOiAnJyxcbiAgICAgICAgICAgIGVtYWlsOiAnJyxcbiAgICAgICAgICAgIHBhc3N3b3JkOiAnJyxcbiAgICAgICAgICAgIGNvbmZpcm1QYXNzd29yZDogJycsXG4gICAgICAgIH07XG5cbiAgICAgICAgcmVndm0ucmVnaXN0ZXIgPSAoKSA9PiB7XG4gICAgICAgICAgICBhdXRoZW50aWNhdGlvblxuICAgICAgICAgICAgICAgIC5zaWduVXAocmVndm0udXNlcilcbiAgICAgICAgICAgICAgICAudGhlbigocmVzcG9uc2UpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEuZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlZ3ZtLlJlZ2lzdHJhdGlvbkVycm9yID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlZ3ZtLlJlZ2lzdHJhdGlvbkVycm9yTXNnID0gcmVzcG9uc2UuZGF0YS5lcnJvcjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlZ3ZtLlJlZ2lzdHJhdGlvbkVycm9yID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAkbG9jYXRpb24ucGF0aCgnL3dlbGNvbWUnKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVndm0uUmVnaXN0cmF0aW9uRXJyb3IgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVndm0uUmVnaXN0cmF0aW9uRXJyb3JNc2cgPSBlcnIuZGF0YS5lcnJvcjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG4gICAgICAgIGlmIChhdXRoZW50aWNhdGlvbi5pc0xvZ2dlZEluKCkpIHtcbiAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKCcvd2VsY29tZScpO1xuICAgICAgICB9XG4gICAgfVxufSkoKTtcbiIsIi8qXG58LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxufCBzZXR0aW5nIHVwIGNvbnRyb2xsZXIgZm9yIGxvZ2luIHBhZ2VcbnwgQGF1dGhvcjogamFoaWQgaGFxdWUgPGphaGlkLmhhcXVlQHlhaG9vLmNvbT5cbnwgQGNvcHlyaWdodDogbmJhc2xwLCAyMDE3XG58LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuKi9cblxuJ3VzZSBzdHJpY3QnO1xuXG4oZnVuY3Rpb24gKCkge1xuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnbmJhc2xwJylcbiAgICAgICAgLmNvbnRyb2xsZXIoJ3NpZ25pbkN0cmwnLCBzaWduaW5DdHJsKTtcblxuICAgIHNpZ25pbkN0cmwuJGluamVjdCA9IFsnYXV0aGVudGljYXRpb24nLCAnJGxvY2F0aW9uJ107XG5cbiAgICBmdW5jdGlvbiBzaWduaW5DdHJsKGF1dGhlbnRpY2F0aW9uLCAkbG9jYXRpb24pIHtcbiAgICAgICAgY29uc3QgbHZtID0gdGhpcztcblxuICAgICAgICBsdm0udXNlciA9IHtcbiAgICAgICAgICAgIGVtYWlsOiAnJyxcbiAgICAgICAgICAgIHBhc3N3b3JkOiAnJyxcbiAgICAgICAgfTsgXG5cbiAgICAgICAgaWYgKGF1dGhlbnRpY2F0aW9uLmlzTG9nZ2VkSW4oKSkge1xuICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoJy93ZWxjb21lJyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBsdm0ubG9naW4gPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKCFsdm0udXNlci5lbWFpbCB8fCAhbHZtLnVzZXIucGFzc3dvcmQpIHtcbiAgICAgICAgICAgICAgICAgICAgbHZtLmxvZ2luRXJyb3IgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBsdm0ubG9naW5FcnJvck1zZyA9IGBFcnJvciEgYWxsICogZmllbGRzIGFyZSByZXF1aXJlZGA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBsdm0ubG9naW5FcnJvciA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBsdm0uZG9Mb2dpbigpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGx2bS5kb0xvZ2luID0gKCkgPT4ge1xuICAgICAgICAgICAgICAgIGF1dGhlbnRpY2F0aW9uXG4gICAgICAgICAgICAgICAgICAgIC5zaWduSW4obHZtLnVzZXIpXG4gICAgICAgICAgICAgICAgICAgIC5lcnJvcigoZXJyKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsdm0ubG9naW5FcnJvciA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBsdm0ubG9naW5FcnJvck1zZyA9IGVyci5lcnJvcjtcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoJy93ZWxjb21lJyk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cblxufSkoKTtcbiIsIi8qXG58LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxufCBzZXR0aW5nIHVwIGNvbnRyb2xsZXIgZm9yIHByb2ZpbGUgcGFnZVxufCBAYXV0aG9yOiBqYWhpZCBoYXF1ZSA8amFoaWQuaGFxdWVAeWFob28uY29tPlxufCBAY29weXJpZ2h0OiBuYmEtc2xwLCAyMDE3XG58LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuKi9cblxuJ3VzZSBzdHJpY3QnO1xuXG4oZnVuY3Rpb24gKCkge1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCduYmFzbHAnKVxuICAgICAgICAuY29udHJvbGxlcigncHJvZmlsZUN0cmwnLCBwcm9maWxlQ3RybCk7XG5cbiAgICBwcm9maWxlQ3RybC4kaW5qZWN0ID0gWydhdXRoZW50aWNhdGlvbicsICckbG9jYXRpb24nLCAnYWNjb3VudCcsICckcm91dGUnXTtcblxuICAgIGZ1bmN0aW9uIHByb2ZpbGVDdHJsKGF1dGhlbnRpY2F0aW9uLCAkbG9jYXRpb24sIGFjY291bnQsICRyb3V0ZSkge1xuXG4gICAgICAgIGNvbnN0IHByb3ZtID0gdGhpcztcblxuICAgICAgICBpZiAoYXV0aGVudGljYXRpb24uaXNMb2dnZWRJbigpKSB7XG4gICAgICAgICAgICBwcm92bS5wcm9maWxlU3RhdHVzID0gYXV0aGVudGljYXRpb24uY3VycmVudFVzZXIoKS5hY2NvdW50U3RhdHVzO1xuXG4gICAgICAgICAgICAvLyBnZXQgdXNlciBhY2NvdW50IHN0YXR1ZXMgXG4gICAgICAgICAgICBwcm92bS5nZXRQcm9maWxlU3RhdHVzZXMgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgYWNjb3VudFxuICAgICAgICAgICAgICAgICAgICAuZ2V0QWNjb3VudFN0YXR1c2VzKGF1dGhlbnRpY2F0aW9uLmN1cnJlbnRVc2VyKCkuZW1haWwpXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKHJlc3BvbnNlID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5kYXRhLmVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvdm0uc3RhdHVzTG9hZEVycm9yID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm92bS5zdGF0dXNMb2FkRXJyb3JNc2cgPSByZXNwb25zZS5kYXRhLmVycm9yO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvdm0uc3RhdHVzTG9hZEVycm9yID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvdm0udXNlclN0YXR1c2VzID0gcmVzcG9uc2UuZGF0YS5zdGF0dXNlcztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLmNhdGNoKGVyciA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcm92bS5zdGF0dXNMb2FkRXJyb3IgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJvdm0uc3RhdHVzTG9hZEVycm9yTXNnID0gZXJyO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIC8vIHNhdmluZyBiYXNpYyBwcm9maWxlIGluZm9cbiAgICAgICAgICAgIHByb3ZtLmJhc2ljUHJvZmlsZSA9IHtcbiAgICAgICAgICAgICAgICB3aG9zOiBhdXRoZW50aWNhdGlvbi5jdXJyZW50VXNlcigpLmVtYWlsLFxuICAgICAgICAgICAgICAgIHVzZXJJZDogYXV0aGVudGljYXRpb24uY3VycmVudFVzZXIoKS51c2VySWQsXG4gICAgICAgICAgICAgICAgZm9ybWVyTmFtZTogJycsXG4gICAgICAgICAgICAgICAgc2V4OiAnJyxcbiAgICAgICAgICAgICAgICB0ZWxlOiAnJyxcbiAgICAgICAgICAgICAgICBhZGRyZXNzOiAnJyxcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHByb3ZtLnNhdmVCYXNpY0luZm8gPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgYWNjb3VudFxuICAgICAgICAgICAgICAgICAgICAuc2F2ZUJhc2ljSW5mbyhwcm92bS5iYXNpY1Byb2ZpbGUpXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKChyZXNwb25zZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEuZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm92bS5iYXNpY0FjY291bnRJbmZvRXJyb3IgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb3ZtLmJhc2ljQWNjb3VudEluZm9FcnJvck1zZyA9IHJlc3BvbnNlLmRhdGEuZXJyb3I7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm92bS5iYXNpY0FjY291bnRJbmZvRXJyb3IgPSBmYWxzZTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb3ZtLnVwZGF0ZWRTdGF0dXMgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZV9hdDogJ2Jhc2ljX2luZm8nLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbWFpbDogYXV0aGVudGljYXRpb24uY3VycmVudFVzZXIoKS5lbWFpbCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjYWxsaW5nIHNlcnZpY2UgZnVuY3Rpb24uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3VudFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAudXBkYXRlVXNlclN0YXR1cyhwcm92bS51cGRhdGVkU3RhdHVzKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihyZXNwb25zZSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzcG9uc2UuZGF0YS5lcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb3ZtLmJhc2ljQWNjb3VudEluZm9FcnJvciA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvdm0uYmFzaWNBY2NvdW50SW5mb0Vycm9yTXNnID0gcmVzcG9uc2UuZGF0YS5lcnJvcjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb3ZtLnN0YXR1c1VwZGF0ZUVycm9yID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJvdXRlLnJlbG9hZCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcblxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAkbG9jYXRpb24ucGF0aCgnL3NpZ25pbicpO1xuICAgICAgICB9XG4gICAgfVxuXG59KSgpO1xuIl19
